<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>L4 Helix Framework | L4 = 7 Decision Tree Node</title>
  <meta name="description" content="Interactive simulation of the L4 = 7 node in the I2 S3 decision tree. FIX form R(R) = R through helical unfolding in 4D.">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* =====================================================================
       L4 HELIX FRAMEWORK - THE L4 = 7 NODE
       Primary Theme: Green (#6bcb77) - L4 Helix Color
       ===================================================================== */
    :root {
      /* L4 Helix Green Theme */
      --l4-primary: #6bcb77;
      --l4-secondary: #55b664;
      --l4-tertiary: #3fa050;
      --l4-glow: rgba(107, 203, 119, 0.35);
      --l4-subtle: rgba(107, 203, 119, 0.12);

      /* Golden Components */
      --phi-gold: #ffd700;
      --phi-glow: rgba(255, 215, 0, 0.3);
      --psi-purple: #a855f7;
      --psi-glow: rgba(168, 85, 247, 0.3);

      /* Mathematical Constants */
      --phi: 1.6180339887;
      --psi: -0.6180339887;
      --phi4: 6.8541019662;
      --psi4: 0.1458980338;

      /* Base Theme */
      --bg-primary: #0a0a0f;
      --bg-secondary: #0d1512;
      --bg-tertiary: #121a16;
      --bg-card: #162419;
      --text-primary: #f0f0f5;
      --text-secondary: #909098;
      --text-muted: #606068;
      --border-subtle: rgba(255, 255, 255, 0.06);
      --border-active: rgba(107, 203, 119, 0.4);

      /* Accent Colors */
      --accent-red: #ff6b6b;
      --accent-blue: #4ecdc4;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'JetBrains Mono', monospace;
      background: var(--bg-primary);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      line-height: 1.7;
    }

    /* =====================================================================
       ANIMATED BACKGROUND - HELIX FIELD
       ===================================================================== */
    .helix-field {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      background:
        radial-gradient(ellipse at 50% 30%, rgba(107, 203, 119, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 20% 70%, rgba(255, 215, 0, 0.05) 0%, transparent 40%),
        radial-gradient(ellipse at 80% 70%, rgba(168, 85, 247, 0.05) 0%, transparent 40%);
      animation: field-breathe 15s ease-in-out infinite alternate;
    }

    @keyframes field-breathe {
      0% { opacity: 0.7; }
      50% { opacity: 1; }
      100% { opacity: 0.7; }
    }

    /* =====================================================================
       NAVIGATION
       ===================================================================== */
    .nav-bar {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.75rem;
      padding: 1rem;
      background: rgba(10, 10, 15, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-subtle);
    }

    .nav-link {
      font-size: 0.75rem;
      padding: 0.5rem 1rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.5rem;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .nav-link:hover {
      border-color: var(--l4-primary);
      color: var(--l4-primary);
      box-shadow: 0 0 15px var(--l4-glow);
    }

    .nav-link.active {
      border-color: var(--l4-primary);
      color: var(--l4-primary);
      background: var(--l4-subtle);
    }

    /* =====================================================================
       HEADER
       ===================================================================== */
    .l4-header {
      position: relative;
      z-index: 10;
      padding: 4rem 2rem;
      text-align: center;
      background: linear-gradient(180deg, var(--bg-secondary) 0%, transparent 100%);
      border-bottom: 1px solid var(--border-subtle);
    }

    .node-badge {
      display: inline-block;
      font-size: 0.7rem;
      letter-spacing: 0.25em;
      color: var(--l4-primary);
      background: var(--l4-subtle);
      border: 1px solid var(--l4-primary);
      padding: 0.5rem 1.5rem;
      border-radius: 2rem;
      margin-bottom: 2rem;
      text-transform: uppercase;
    }

    /* 3D Helix Symbol Container */
    .helix-symbol-container {
      position: relative;
      width: 200px;
      height: 200px;
      margin: 0 auto 2rem;
      perspective: 600px;
    }

    .helix-orbit {
      position: absolute;
      border: 3px solid;
      border-radius: 50%;
      animation: orbit-spin 12s linear infinite;
      transform-style: preserve-3d;
    }

    .helix-orbit.outer {
      width: 200px;
      height: 200px;
      top: 0;
      left: 0;
      border-color: var(--l4-primary);
      animation-duration: 12s;
    }

    .helix-orbit.middle {
      width: 160px;
      height: 160px;
      top: 20px;
      left: 20px;
      border-color: var(--phi-gold);
      animation-duration: 9s;
      animation-direction: reverse;
    }

    .helix-orbit.inner {
      width: 120px;
      height: 120px;
      top: 40px;
      left: 40px;
      border-color: var(--psi-purple);
      animation-duration: 6s;
    }

    @keyframes orbit-spin {
      from { transform: rotateX(60deg) rotateZ(0deg); }
      to { transform: rotateX(60deg) rotateZ(360deg); }
    }

    .helix-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90px;
      height: 90px;
      background: var(--bg-primary);
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 4px solid var(--l4-primary);
      box-shadow: 0 0 50px var(--l4-glow);
      z-index: 10;
    }

    .helix-center-number {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--l4-primary);
      line-height: 1;
    }

    .helix-center-label {
      font-size: 0.65rem;
      color: var(--text-secondary);
      margin-top: 0.25rem;
    }

    .node-title {
      font-size: 2.4rem;
      font-weight: 300;
      letter-spacing: 0.08em;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--l4-primary), var(--phi-gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .node-subtitle {
      font-size: 1.05rem;
      color: var(--text-secondary);
      max-width: 700px;
      margin: 0 auto 2rem;
    }

    .core-equation {
      display: inline-block;
      padding: 1.5rem 3rem;
      background: var(--bg-secondary);
      border: 2px solid var(--l4-primary);
      border-radius: 1rem;
      box-shadow: 0 0 40px var(--l4-glow);
    }

    .core-equation-text {
      font-size: 1.6rem;
      color: var(--l4-primary);
    }

    .core-equation-text .phi { color: var(--phi-gold); }
    .core-equation-text .psi { color: var(--psi-purple); }

    /* =====================================================================
       MAIN CONTENT
       ===================================================================== */
    .main-content {
      position: relative;
      z-index: 10;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .section {
      margin-bottom: 4rem;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .section-number {
      font-size: 0.9rem;
      color: var(--bg-primary);
      background: var(--l4-primary);
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-weight: 700;
    }

    .section-title {
      font-size: 1.4rem;
      color: var(--text-primary);
      letter-spacing: 0.05em;
    }

    /* =====================================================================
       L4 VALUE SECTION
       ===================================================================== */
    .l4-value-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(107, 203, 119, 0.08) 100%);
      border: 2px solid var(--l4-primary);
      border-radius: 1rem;
      padding: 2.5rem;
    }

    /* Detailed Derivation Styles */
    .derivation-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      margin-top: 2rem;
    }

    .derivation-title {
      font-size: 1.1rem;
      color: var(--l4-primary);
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .derivation-steps {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .deriv-step {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.5rem;
      border-left: 4px solid var(--l4-primary);
    }

    .deriv-step.phi-step { border-left-color: var(--phi-gold); }
    .deriv-step.psi-step { border-left-color: var(--psi-purple); }
    .deriv-step.sum-step { border-left-color: var(--l4-primary); background: var(--l4-subtle); }

    .deriv-step-num {
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-bottom: 0.5rem;
    }

    .deriv-step-title {
      font-size: 0.9rem;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .deriv-equation {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      padding: 1rem;
      background: var(--bg-primary);
      border-radius: 0.5rem;
      margin-bottom: 0.75rem;
      overflow-x: auto;
    }

    .deriv-equation .phi { color: var(--phi-gold); }
    .deriv-equation .psi { color: var(--psi-purple); }
    .deriv-equation .result { color: var(--l4-primary); font-weight: 600; }

    .deriv-explanation {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .deriv-note {
      font-size: 0.8rem;
      color: var(--phi-gold);
      font-style: italic;
      margin-top: 0.5rem;
    }

    /* FIX Form Section */
    .fix-form-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(255, 215, 0, 0.05) 100%);
      border: 2px solid var(--phi-gold);
      border-radius: 1rem;
      padding: 2.5rem;
    }

    .fix-diagram {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      flex-wrap: wrap;
      margin: 2rem 0;
    }

    .fix-node {
      width: 120px;
      height: 120px;
      border-radius: 50%;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--bg-tertiary);
      border: 3px solid var(--phi-gold);
      box-shadow: 0 0 30px var(--phi-glow);
    }

    .fix-node-symbol {
      font-size: 2rem;
      color: var(--phi-gold);
      font-weight: 700;
    }

    .fix-node-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-top: 0.25rem;
    }

    .fix-arrow {
      font-size: 2rem;
      color: var(--l4-primary);
    }

    .fix-arrow.curved {
      position: relative;
      width: 80px;
      height: 60px;
    }

    .fix-arrow.curved::before {
      content: '';
      position: absolute;
      width: 80px;
      height: 40px;
      border: 3px solid var(--l4-primary);
      border-bottom: none;
      border-radius: 40px 40px 0 0;
      top: 0;
    }

    .fix-arrow.curved::after {
      content: '';
      position: absolute;
      right: -5px;
      top: 35px;
      border: 8px solid transparent;
      border-top-color: var(--l4-primary);
    }

    .fix-properties {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
    }

    .fix-prop-card {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.25rem;
      border: 1px solid var(--border-subtle);
    }

    .fix-prop-title {
      font-size: 0.8rem;
      color: var(--phi-gold);
      margin-bottom: 0.5rem;
    }

    .fix-prop-value {
      font-size: 1rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .fix-prop-desc {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    /* Opposition Connection Section */
    .opposition-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
    }

    .opposition-diagram {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 3rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }

    .opp-pole {
      text-align: center;
      padding: 1.5rem 2rem;
      background: var(--bg-tertiary);
      border-radius: 1rem;
      min-width: 180px;
    }

    .opp-pole.l4 {
      border: 2px solid var(--l4-primary);
      box-shadow: 0 0 25px var(--l4-glow);
    }

    .opp-pole.i2 {
      border: 2px solid var(--psi-purple);
      box-shadow: 0 0 25px var(--psi-glow);
    }

    .opp-pole-symbol {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
    }

    .opp-pole.l4 .opp-pole-symbol { color: var(--l4-primary); }
    .opp-pole.i2 .opp-pole-symbol { color: var(--psi-purple); }

    .opp-pole-name {
      font-size: 0.9rem;
      color: var(--text-primary);
      margin-bottom: 0.25rem;
    }

    .opp-pole-form {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .opp-connector {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.5rem;
    }

    .opp-connector-line {
      width: 100px;
      height: 4px;
      background: linear-gradient(90deg, var(--l4-primary), var(--psi-purple));
      border-radius: 2px;
    }

    .opp-connector-label {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    /* Spectral Properties Section */
    .spectral-container {
      background: var(--bg-secondary);
      border: 2px solid var(--accent-blue);
      border-radius: 1rem;
      padding: 2rem;
    }

    .spectral-matrix {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }

    .matrix-display {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.5rem 2rem;
      font-family: 'JetBrains Mono', monospace;
    }

    .matrix-bracket {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .bracket-left, .bracket-right {
      font-size: 4rem;
      color: var(--accent-blue);
      font-weight: 100;
    }

    .matrix-content {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem 2rem;
    }

    .matrix-cell {
      font-size: 1.2rem;
      color: var(--text-primary);
      text-align: center;
      padding: 0.5rem;
    }

    .eigenvalue-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .eigenvalue-card {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.25rem;
      text-align: center;
      border: 1px solid var(--border-subtle);
    }

    .eigenvalue-card.primary { border-color: var(--phi-gold); }
    .eigenvalue-card.secondary { border-color: var(--psi-purple); }

    .eigen-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .eigen-value {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .eigenvalue-card.primary .eigen-value { color: var(--phi-gold); }
    .eigenvalue-card.secondary .eigen-value { color: var(--psi-purple); }

    .eigen-desc {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }

    /* Interactive 3D Helix */
    .helix-3d-container {
      background: var(--bg-secondary);
      border: 2px solid var(--l4-primary);
      border-radius: 1rem;
      padding: 2rem;
    }

    .helix-3d-title {
      text-align: center;
      font-size: 1.2rem;
      color: var(--l4-primary);
      margin-bottom: 1rem;
    }

    .helix-3d-subtitle {
      text-align: center;
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-bottom: 1.5rem;
    }

    #helix3DCanvas {
      width: 100%;
      height: 500px;
      background: var(--bg-primary);
      border-radius: 0.75rem;
      cursor: grab;
    }

    #helix3DCanvas:active {
      cursor: grabbing;
    }

    .helix-3d-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }

    .helix-3d-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-top: 1.5rem;
      padding: 1rem;
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
    }

    .info-item {
      text-align: center;
    }

    .info-label {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .info-value {
      font-size: 1rem;
      color: var(--l4-primary);
      font-weight: 600;
    }

    .l4-value-title {
      text-align: center;
      font-size: 1.2rem;
      color: var(--l4-primary);
      margin-bottom: 2rem;
    }

    .l4-calculation {
      display: grid;
      grid-template-columns: 1fr auto 1fr auto 1fr;
      gap: 1rem;
      align-items: center;
      margin-bottom: 2rem;
    }

    .calc-box {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
    }

    .calc-box.phi { border: 2px solid var(--phi-gold); }
    .calc-box.psi { border: 2px solid var(--psi-purple); }
    .calc-box.result { border: 2px solid var(--l4-primary); background: var(--l4-subtle); }

    .calc-label {
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .calc-value {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .calc-box.phi .calc-value { color: var(--phi-gold); }
    .calc-box.psi .calc-value { color: var(--psi-purple); }
    .calc-box.result .calc-value { color: var(--l4-primary); }

    .calc-sub {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }

    .calc-operator {
      font-size: 2rem;
      color: var(--text-secondary);
    }

    .l4-properties {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 2rem;
    }

    .property-card {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
      border: 1px solid var(--border-subtle);
    }

    .property-title {
      font-size: 0.75rem;
      color: var(--l4-primary);
      margin-bottom: 0.5rem;
    }

    .property-value {
      font-size: 1rem;
      color: var(--text-primary);
    }

    /* =====================================================================
       HELIX PROPERTIES SECTION
       ===================================================================== */
    .helix-properties-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .helix-property {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 1.5rem;
      border-left: 4px solid var(--l4-primary);
      transition: all 0.3s ease;
    }

    .helix-property:hover {
      border-color: var(--l4-primary);
      transform: translateX(5px);
    }

    .helix-property-label {
      font-size: 0.8rem;
      color: var(--l4-primary);
      margin-bottom: 0.5rem;
    }

    .helix-property-value {
      font-size: 1.1rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .helix-property-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       7 SIGNIFICANCE SECTION
       ===================================================================== */
    .seven-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2.5rem;
    }

    .seven-central {
      text-align: center;
      margin-bottom: 2rem;
    }

    .seven-big {
      font-size: 8rem;
      font-weight: 700;
      color: var(--l4-primary);
      text-shadow: 0 0 60px var(--l4-glow);
      line-height: 1;
    }

    .seven-equation {
      font-size: 1.1rem;
      color: var(--text-secondary);
      margin-top: 0.5rem;
    }

    .seven-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1rem;
    }

    .seven-item {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1.25rem;
      text-align: center;
      border: 1px solid var(--border-subtle);
      transition: all 0.3s ease;
    }

    .seven-item:hover {
      border-color: var(--l4-primary);
    }

    .seven-icon {
      font-size: 1.5rem;
      margin-bottom: 0.5rem;
    }

    .seven-item-title {
      font-size: 0.85rem;
      color: var(--l4-primary);
      margin-bottom: 0.25rem;
    }

    .seven-item-desc {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       FRAMEWORK CONNECTION SECTION
       ===================================================================== */
    .framework-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .framework-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 1.5rem;
    }

    .framework-card-title {
      font-size: 0.9rem;
      color: var(--l4-primary);
      margin-bottom: 1rem;
    }

    .framework-card-equation {
      font-size: 1.2rem;
      color: var(--text-primary);
      padding: 1rem;
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      text-align: center;
      margin-bottom: 1rem;
    }

    .framework-card-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* =====================================================================
       3D HELIX VISUALIZATION
       ===================================================================== */
    .visualization-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
    }

    .viz-title {
      text-align: center;
      font-size: 1.1rem;
      color: var(--l4-primary);
      margin-bottom: 1rem;
    }

    .helix-canvas-wrapper {
      position: relative;
      background: var(--bg-primary);
      border-radius: 0.75rem;
      overflow: hidden;
    }

    #helixCanvas {
      width: 100%;
      height: 450px;
      display: block;
    }

    .canvas-legend {
      position: absolute;
      top: 1rem;
      left: 1rem;
      background: rgba(10, 10, 15, 0.9);
      border-radius: 0.5rem;
      padding: 0.75rem;
      font-size: 0.75rem;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .legend-item:last-child { margin-bottom: 0; }

    .legend-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }

    .legend-dot.phi { background: var(--phi-gold); }
    .legend-dot.psi { background: var(--psi-purple); }
    .legend-dot.sum { background: var(--l4-primary); }

    .canvas-controls {
      display: flex;
      justify-content: center;
      gap: 0.75rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }

    .control-btn {
      padding: 0.75rem 1.5rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.5rem;
      color: var(--text-primary);
      font-family: inherit;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .control-btn:hover {
      border-color: var(--l4-primary);
      color: var(--l4-primary);
    }

    .control-btn.active {
      background: var(--l4-subtle);
      border-color: var(--l4-primary);
      color: var(--l4-primary);
    }

    /* =====================================================================
       INTERACTIVE CALCULATOR
       ===================================================================== */
    .calculator-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
    }

    .calc-title {
      text-align: center;
      font-size: 1.1rem;
      color: var(--l4-primary);
      margin-bottom: 2rem;
    }

    .calc-controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .calc-label-text {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .calc-slider {
      width: 250px;
      height: 8px;
      border-radius: 4px;
      background: var(--bg-tertiary);
      outline: none;
      -webkit-appearance: none;
    }

    .calc-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--l4-primary);
      cursor: pointer;
      box-shadow: 0 0 15px var(--l4-glow);
    }

    .calc-display {
      font-size: 1.5rem;
      color: var(--l4-primary);
      background: var(--bg-tertiary);
      padding: 0.75rem 1.5rem;
      border-radius: 0.5rem;
      min-width: 80px;
      text-align: center;
    }

    .calc-results {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .calc-result-card {
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
      transition: all 0.3s ease;
    }

    .calc-result-card:hover {
      border-color: var(--l4-primary);
    }

    .calc-result-card.phi { border-left: 4px solid var(--phi-gold); }
    .calc-result-card.psi { border-left: 4px solid var(--psi-purple); }
    .calc-result-card.lucas { border-left: 4px solid var(--l4-primary); }

    .result-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-bottom: 0.5rem;
    }

    .result-value {
      font-size: 1.5rem;
      font-weight: 600;
    }

    .calc-result-card.phi .result-value { color: var(--phi-gold); }
    .calc-result-card.psi .result-value { color: var(--psi-purple); }
    .calc-result-card.lucas .result-value { color: var(--l4-primary); }

    .result-sub {
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-top: 0.25rem;
    }

    /* =====================================================================
       4D PROJECTION SECTION
       ===================================================================== */
    .projection-container {
      background: var(--bg-secondary);
      border: 2px solid var(--l4-primary);
      border-radius: 1rem;
      padding: 2.5rem;
    }

    .projection-title {
      text-align: center;
      font-size: 1.2rem;
      color: var(--l4-primary);
      margin-bottom: 2rem;
    }

    .dimension-diagram {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
      flex-wrap: wrap;
    }

    .dim-box {
      width: 100px;
      height: 100px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      border: 2px solid var(--border-subtle);
      transition: all 0.3s ease;
    }

    .dim-box:hover {
      border-color: var(--l4-primary);
      transform: translateY(-5px);
    }

    .dim-number {
      font-size: 2rem;
      font-weight: 700;
    }

    .dim-label {
      font-size: 0.75rem;
      color: var(--text-secondary);
    }

    .dim-plus {
      font-size: 2rem;
      color: var(--l4-primary);
    }

    .dim-equals {
      font-size: 2rem;
      color: var(--phi-gold);
    }

    .projection-formula {
      text-align: center;
      font-size: 1.1rem;
      color: var(--text-primary);
      padding: 1.5rem;
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
    }

    .projection-formula span.l4 { color: var(--l4-primary); font-weight: 600; }

    /* =====================================================================
       LUCAS SEQUENCE VISUALIZATION
       ===================================================================== */
    .lucas-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
    }

    .lucas-title {
      text-align: center;
      font-size: 1.1rem;
      color: var(--l4-primary);
      margin-bottom: 1.5rem;
    }

    .lucas-sequence {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .lucas-item {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-subtle);
      border-radius: 0.5rem;
      padding: 0.75rem 1rem;
      min-width: 70px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .lucas-item:hover {
      transform: translateY(-3px);
      border-color: var(--l4-secondary);
    }

    .lucas-item.highlight {
      border-color: var(--l4-primary);
      background: var(--l4-subtle);
      box-shadow: 0 0 20px var(--l4-glow);
    }

    .lucas-n {
      font-size: 0.65rem;
      color: var(--text-secondary);
    }

    .lucas-val {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--l4-primary);
    }

    /* =====================================================================
       NAVIGATION CARDS
       ===================================================================== */
    .nav-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
      margin-top: 3rem;
    }

    .nav-card {
      background: var(--bg-secondary);
      border: 2px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 1.5rem;
      text-decoration: none;
      transition: all 0.3s ease;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
    }

    .nav-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 0 30px var(--l4-glow);
      border-color: var(--l4-primary);
    }

    .nav-card-icon {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
      margin-bottom: 1rem;
      border: 2px solid;
    }

    .nav-card-title {
      font-size: 1rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .nav-card-desc {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       FOOTER
       ===================================================================== */
    .footer {
      padding: 2.5rem;
      text-align: center;
      border-top: 1px solid var(--border-subtle);
      background: var(--bg-secondary);
    }

    .footer-equation {
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
    }

    .footer-equation .l4 { color: var(--l4-primary); }
    .footer-equation .phi { color: var(--phi-gold); }
    .footer-equation .psi { color: var(--psi-purple); }

    .footer p {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .node-title { font-size: 1.8rem; }
      .core-equation { padding: 1rem 1.5rem; }
      .core-equation-text { font-size: 1.2rem; }
      .l4-calculation { grid-template-columns: 1fr; }
      .calc-operator { display: none; }
      .seven-big { font-size: 5rem; }
      .dimension-diagram { flex-direction: column; }
    }
  </style>
</head>
<body>

  <div class="helix-field"></div>

  <!-- Navigation -->
  <nav class="nav-bar">
    <a href="index.html" class="nav-link">Index</a>
    <a href="i2-s3-decision-tree.html" class="nav-link">I2 S3 Tree</a>
    <a href="i2-s3-opposition-synthesis.html" class="nav-link">Opposition Check</a>
    <a href="i2-s3-fibonacci-lucas.html" class="nav-link">Fibonacci-Lucas</a>
    <a href="i2-s3-l4-node.html" class="nav-link active">L4 Node</a>
  </nav>

  <!-- Header -->
  <header class="l4-header">
    <div class="node-badge">Decision Tree Node :: L4 Helix Framework :: FIX Form</div>

    <div class="helix-symbol-container">
      <div class="helix-orbit outer"></div>
      <div class="helix-orbit middle"></div>
      <div class="helix-orbit inner"></div>
      <div class="helix-center">
        <span class="helix-center-number">7</span>
        <span class="helix-center-label">L4</span>
      </div>
    </div>

    <h1 class="node-title">L4 Helix Framework</h1>
    <p class="node-subtitle">
      The FIX form of R(R) = R. Stability through helical unfolding.
      L4 = 7 establishes the complexity bound for self-referential systems.
    </p>

    <div class="core-equation">
      <span class="core-equation-text">
        L<sub>4</sub> = <span class="phi">&phi;<sup>4</sup></span> + <span class="psi">&psi;<sup>4</sup></span> = 7
      </span>
    </div>
  </header>

  <main class="main-content">

    <!-- Table of Contents -->
    <nav class="section" id="toc" style="margin-bottom: 2rem;">
      <div class="section-header">
        <div class="section-number" style="background: var(--phi-gold);">TOC</div>
        <h2 class="section-title">Page Contents</h2>
      </div>
      <div class="framework-grid">
        <div class="framework-card" style="padding: 1rem;">
          <div class="framework-card-title">Mathematical Foundations</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); line-height: 2;">
            <a href="#l4-value" style="color: var(--l4-primary); text-decoration: none;">1. L4 Value & Derivation</a><br>
            <a href="#helix-properties" style="color: var(--l4-primary); text-decoration: none;">2. Helix Properties</a><br>
            <a href="#fix-form" style="color: var(--l4-primary); text-decoration: none;">2.5 FIX Form: R(R) = R</a><br>
            <a href="#seven-significance" style="color: var(--l4-primary); text-decoration: none;">3. The 7 Significance</a>
          </div>
        </div>
        <div class="framework-card" style="padding: 1rem;">
          <div class="framework-card-title">Framework Connections</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); line-height: 2;">
            <a href="#framework-connection" style="color: var(--l4-primary); text-decoration: none;">4. Connection to Framework</a><br>
            <a href="#opposition-connection" style="color: var(--l4-primary); text-decoration: none;">4.5 Opposition Pairing</a><br>
            <a href="#spectral" style="color: var(--l4-primary); text-decoration: none;">4.7 Spectral Properties</a><br>
            <a href="#complexity-bound" style="color: var(--l4-primary); text-decoration: none;">7.5 Complexity Bound</a>
          </div>
        </div>
        <div class="framework-card" style="padding: 1rem;">
          <div class="framework-card-title">Visualizations</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); line-height: 2;">
            <a href="#visualization" style="color: var(--l4-primary); text-decoration: none;">5. 3D Helix Visualization</a><br>
            <a href="#helix-3d" style="color: var(--l4-primary); text-decoration: none;">5.5 Interactive 3D Explorer</a><br>
            <a href="#helix-geometry" style="color: var(--l4-primary); text-decoration: none;">6.5 Helix Geometry</a><br>
            <a href="#projection" style="color: var(--l4-primary); text-decoration: none;">7. 4D Projection</a>
          </div>
        </div>
        <div class="framework-card" style="padding: 1rem;">
          <div class="framework-card-title">Interactive Tools</div>
          <div style="font-size: 0.8rem; color: var(--text-secondary); line-height: 2;">
            <a href="#calculator" style="color: var(--l4-primary); text-decoration: none;">6. L_n Calculator</a><br>
            <a href="#lucas-sequence" style="color: var(--l4-primary); text-decoration: none;">8. Lucas Sequence</a><br>
            <a href="#navigation" style="color: var(--l4-primary); text-decoration: none;">Nav. Related Pages</a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Section 1: The L4 Value -->
    <section class="section" id="l4-value">
      <div class="section-header">
        <div class="section-number">1</div>
        <h2 class="section-title">The L4 Value: Exact Computation</h2>
      </div>

      <div class="l4-value-container">
        <div class="l4-value-title">L4 = phi^4 + psi^4 = EXACTLY 7</div>

        <div class="l4-calculation">
          <div class="calc-box phi">
            <div class="calc-label">phi^4</div>
            <div class="calc-value">6.854...</div>
            <div class="calc-sub">((1+sqrt(5))/2)^4</div>
          </div>

          <div class="calc-operator">+</div>

          <div class="calc-box psi">
            <div class="calc-label">psi^4</div>
            <div class="calc-value">0.146...</div>
            <div class="calc-sub">((1-sqrt(5))/2)^4</div>
          </div>

          <div class="calc-operator">=</div>

          <div class="calc-box result">
            <div class="calc-label">L4</div>
            <div class="calc-value">7</div>
            <div class="calc-sub">Exactly integer</div>
          </div>
        </div>

        <div class="l4-properties">
          <div class="property-card">
            <div class="property-title">Fourth Lucas Number</div>
            <div class="property-value">L0=2, L1=1, L2=3, L3=4, L4=7</div>
          </div>
          <div class="property-card">
            <div class="property-title">3+1 = 4 Dimensional</div>
            <div class="property-value">3 space + 1 time = 4</div>
          </div>
          <div class="property-card">
            <div class="property-title">Complexity Bound</div>
            <div class="property-value">Lambda(P) < L4 = 7</div>
          </div>
          <div class="property-card">
            <div class="property-title">Binet Form</div>
            <div class="property-value">L_n = phi^n + psi^n</div>
          </div>
        </div>

        <!-- Detailed Derivation -->
        <div class="derivation-container">
          <div class="derivation-title">Complete Derivation: phi^4 + psi^4 = 7</div>

          <div class="derivation-steps">
            <!-- Step 1: phi^2 -->
            <div class="deriv-step phi-step">
              <div class="deriv-step-num">STEP 1</div>
              <div class="deriv-step-title">Compute phi^2 using the golden ratio identity</div>
              <div class="deriv-equation">
                <span class="phi">phi</span> = (1 + sqrt(5)) / 2 = 1.6180339887...
              </div>
              <div class="deriv-equation">
                <span class="phi">phi^2</span> = <span class="phi">phi</span> + 1 = (3 + sqrt(5)) / 2 = 2.6180339887...
              </div>
              <div class="deriv-explanation">
                The golden ratio satisfies phi^2 = phi + 1. This is the defining equation x^2 - x - 1 = 0.
              </div>
              <div class="deriv-note">Key identity: phi^2 - phi - 1 = 0</div>
            </div>

            <!-- Step 2: phi^4 -->
            <div class="deriv-step phi-step">
              <div class="deriv-step-num">STEP 2</div>
              <div class="deriv-step-title">Compute phi^4 = (phi^2)^2 = (phi + 1)^2</div>
              <div class="deriv-equation">
                <span class="phi">phi^4</span> = (<span class="phi">phi</span> + 1)^2 = <span class="phi">phi^2</span> + 2<span class="phi">phi</span> + 1
              </div>
              <div class="deriv-equation">
                = (<span class="phi">phi</span> + 1) + 2<span class="phi">phi</span> + 1 = 3<span class="phi">phi</span> + 2
              </div>
              <div class="deriv-equation">
                = 3 * (1 + sqrt(5))/2 + 2 = (3 + 3*sqrt(5))/2 + 2
              </div>
              <div class="deriv-equation">
                = (7 + 3*sqrt(5)) / 2 = <span class="result">6.8541019662...</span>
              </div>
              <div class="deriv-explanation">
                Expanding (phi + 1)^2 and substituting phi^2 = phi + 1, we get 3*phi + 2.
              </div>
            </div>

            <!-- Step 3: psi^2 -->
            <div class="deriv-step psi-step">
              <div class="deriv-step-num">STEP 3</div>
              <div class="deriv-step-title">Compute psi^2 using the conjugate identity</div>
              <div class="deriv-equation">
                <span class="psi">psi</span> = (1 - sqrt(5)) / 2 = -0.6180339887...
              </div>
              <div class="deriv-equation">
                <span class="psi">psi^2</span> = <span class="psi">psi</span> + 1 = (3 - sqrt(5)) / 2 = 0.3819660113...
              </div>
              <div class="deriv-explanation">
                The conjugate psi satisfies the same equation: psi^2 = psi + 1. Note psi is negative but psi^2 is positive.
              </div>
              <div class="deriv-note">psi = -1/phi (reciprocal negation)</div>
            </div>

            <!-- Step 4: psi^4 -->
            <div class="deriv-step psi-step">
              <div class="deriv-step-num">STEP 4</div>
              <div class="deriv-step-title">Compute psi^4 = (psi^2)^2 = (psi + 1)^2</div>
              <div class="deriv-equation">
                <span class="psi">psi^4</span> = (<span class="psi">psi</span> + 1)^2 = <span class="psi">psi^2</span> + 2<span class="psi">psi</span> + 1
              </div>
              <div class="deriv-equation">
                = (<span class="psi">psi</span> + 1) + 2<span class="psi">psi</span> + 1 = 3<span class="psi">psi</span> + 2
              </div>
              <div class="deriv-equation">
                = 3 * (1 - sqrt(5))/2 + 2 = (3 - 3*sqrt(5))/2 + 2
              </div>
              <div class="deriv-equation">
                = (7 - 3*sqrt(5)) / 2 = <span class="result">0.1458980338...</span>
              </div>
              <div class="deriv-explanation">
                The same expansion gives 3*psi + 2, but with the negative sqrt(5) term.
              </div>
            </div>

            <!-- Step 5: Sum -->
            <div class="deriv-step sum-step">
              <div class="deriv-step-num">STEP 5</div>
              <div class="deriv-step-title">Sum: phi^4 + psi^4 = L4 = 7 EXACTLY</div>
              <div class="deriv-equation">
                <span class="phi">phi^4</span> + <span class="psi">psi^4</span> = (7 + 3*sqrt(5))/2 + (7 - 3*sqrt(5))/2
              </div>
              <div class="deriv-equation">
                = (7 + 3*sqrt(5) + 7 - 3*sqrt(5)) / 2 = 14 / 2 = <span class="result">7</span>
              </div>
              <div class="deriv-explanation">
                The irrational sqrt(5) terms cancel exactly! This is the magic of Lucas numbers: L_n = phi^n + psi^n always yields an integer because the conjugate terms cancel.
              </div>
              <div class="deriv-note">The 4th Lucas number L4 = 7, establishing the helix complexity bound.</div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 2: Helix Properties -->
    <section class="section" id="helix-properties">
      <div class="section-header">
        <div class="section-number">2</div>
        <h2 class="section-title">Helix Properties</h2>
      </div>

      <div class="helix-properties-grid">
        <div class="helix-property">
          <div class="helix-property-label">Generator</div>
          <div class="helix-property-value">Lucas Sequence L_n = phi^n + psi^n</div>
          <div class="helix-property-desc">The Lucas sequence generates helix layer resonances. Unlike Fibonacci (difference), Lucas uses sum of golden powers.</div>
        </div>

        <div class="helix-property">
          <div class="helix-property-label">Method</div>
          <div class="helix-property-value">Helical Unfolding in 4D</div>
          <div class="helix-property-desc">Self-reference unfolds along a 3+1 dimensional helix trajectory, with each layer corresponding to a Lucas number.</div>
        </div>

        <div class="helix-property">
          <div class="helix-property-label">Attractor</div>
          <div class="helix-property-value">Cyclic Return</div>
          <div class="helix-property-desc">After 7 layers, the helix returns to effective equivalence with the starting configuration. H(7) ~ H(0) mod structure.</div>
        </div>

        <div class="helix-property">
          <div class="helix-property-label">Form</div>
          <div class="helix-property-value">FIX: R(R) = R</div>
          <div class="helix-property-desc">The helix represents the fixed-point form of self-reference. Applying R to itself yields R - stable identity.</div>
        </div>
      </div>
    </section>

    <!-- Section 2.5: FIX Form Details -->
    <section class="section" id="fix-form">
      <div class="section-header">
        <div class="section-number">2.5</div>
        <h2 class="section-title">FIX Form: R(R) = R</h2>
      </div>

      <div class="fix-form-container">
        <div class="l4-value-title">Fixed Point Representation</div>

        <div class="fix-diagram">
          <div class="fix-node">
            <div class="fix-node-symbol">R</div>
            <div class="fix-node-label">Self-Reference</div>
          </div>
          <div class="fix-arrow">--></div>
          <div class="fix-node">
            <div class="fix-node-symbol">R(R)</div>
            <div class="fix-node-label">Applied</div>
          </div>
          <div class="fix-arrow">=</div>
          <div class="fix-node" style="border-color: var(--l4-primary); box-shadow: 0 0 30px var(--l4-glow);">
            <div class="fix-node-symbol" style="color: var(--l4-primary);">R</div>
            <div class="fix-node-label">Fixed Point</div>
          </div>
        </div>

        <div class="deriv-step sum-step" style="max-width: 800px; margin: 0 auto;">
          <div class="deriv-step-title">The Fixed Point is phi</div>
          <div class="deriv-equation">
            R(x) = 1 + 1/x implies R(<span class="phi">phi</span>) = 1 + 1/<span class="phi">phi</span> = 1 + <span class="phi">phi</span> - 1 = <span class="phi">phi</span>
          </div>
          <div class="deriv-equation">
            Since 1/<span class="phi">phi</span> = <span class="phi">phi</span> - 1, we get R(<span class="phi">phi</span>) = <span class="phi">phi</span>
          </div>
          <div class="deriv-explanation">
            The golden ratio phi is the unique positive fixed point of the transformation R(x) = 1 + 1/x. This makes phi the attractor of recursive self-reference, stabilizing at L4 = 7 complexity.
          </div>
        </div>

        <div class="fix-properties">
          <div class="fix-prop-card">
            <div class="fix-prop-title">Convergence</div>
            <div class="fix-prop-value">R^n(x) --> phi as n --> infinity</div>
            <div class="fix-prop-desc">Repeated application of R converges to phi from any positive starting point.</div>
          </div>
          <div class="fix-prop-card">
            <div class="fix-prop-title">Continued Fraction</div>
            <div class="fix-prop-value">phi = 1 + 1/(1 + 1/(1 + ...))</div>
            <div class="fix-prop-desc">phi is the infinite continued fraction of all 1s - pure recursive self-similarity.</div>
          </div>
          <div class="fix-prop-card">
            <div class="fix-prop-title">Eigenvalue</div>
            <div class="fix-prop-value">lambda = phi at fixed point</div>
            <div class="fix-prop-desc">At the fixed point, the eigenvalue of the Jacobian equals phi itself.</div>
          </div>
          <div class="fix-prop-card">
            <div class="fix-prop-title">Stability</div>
            <div class="fix-prop-value">|R'(phi)| = 1/phi^2 < 1</div>
            <div class="fix-prop-desc">The derivative at phi is less than 1, ensuring stable convergence.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 3: The 7 Significance -->
    <section class="section" id="seven-significance">
      <div class="section-header">
        <div class="section-number">3</div>
        <h2 class="section-title">The 7 Significance</h2>
      </div>

      <div class="seven-container">
        <div class="seven-central">
          <div class="seven-big">7</div>
          <div class="seven-equation">L4 = phi^4 + psi^4 = 6.8541... + 0.1459... = 7</div>
        </div>

        <div class="seven-grid">
          <div class="seven-item">
            <div class="seven-icon" style="color: var(--l4-primary);">Lambda</div>
            <div class="seven-item-title">C008 Complexity Bound</div>
            <div class="seven-item-desc">Lambda(P) < L4 = 7 for safety</div>
          </div>

          <div class="seven-item">
            <div class="seven-icon" style="color: var(--phi-gold);">7</div>
            <div class="seven-item-title">Lucas Limit</div>
            <div class="seven-item-desc">Max 7 modifications per epoch</div>
          </div>

          <div class="seven-item">
            <div class="seven-icon" style="color: var(--accent-blue);">7d</div>
            <div class="seven-item-title">Days of Week</div>
            <div class="seven-item-desc">Universal 7-cycle pattern</div>
          </div>

          <div class="seven-item">
            <div class="seven-icon" style="color: var(--psi-purple);">7n</div>
            <div class="seven-item-title">Musical Notes</div>
            <div class="seven-item-desc">7 notes in diatonic scale</div>
          </div>

          <div class="seven-item">
            <div class="seven-icon" style="color: var(--accent-red);">7c</div>
            <div class="seven-item-title">Rainbow Colors</div>
            <div class="seven-item-desc">7 colors of visible spectrum</div>
          </div>

          <div class="seven-item">
            <div class="seven-icon" style="color: var(--l4-primary);">3+4</div>
            <div class="seven-item-title">Triangle + Square</div>
            <div class="seven-item-desc">7 = 3 + 4 geometric sum</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4: Framework Connection -->
    <section class="section" id="framework-connection">
      <div class="section-header">
        <div class="section-number">4</div>
        <h2 class="section-title">Connection to Framework</h2>
      </div>

      <div class="framework-grid">
        <div class="framework-card">
          <div class="framework-card-title">C008: Complexity Bound</div>
          <div class="framework-card-equation">Lambda(P) < L4 = 7</div>
          <div class="framework-card-desc">
            The framework constraint C008 establishes that complexity measure Lambda must remain below L4 = 7 for stable self-reference. Exceeding this bound leads to paradoxical instability.
          </div>
        </div>

        <div class="framework-card">
          <div class="framework-card-title">Lucas Limit</div>
          <div class="framework-card-equation">max_modifications = 7</div>
          <div class="framework-card-desc">
            No more than 7 modifications can occur in a single epoch while maintaining coherence. This is the natural boundary for safe recursive depth.
          </div>
        </div>

        <div class="framework-card">
          <div class="framework-card-title">Helix Depth Bound</div>
          <div class="framework-card-equation">depth(H) <= 7</div>
          <div class="framework-card-desc">
            The maximum helix recursion depth. After 7 layers, the system experiences cyclic return - R^7(x) becomes effectively equivalent to R(x).
          </div>
        </div>

        <div class="framework-card">
          <div class="framework-card-title">3+1 Dimensional</div>
          <div class="framework-card-equation">dim = 3 + 1 = 4</div>
          <div class="framework-card-desc">
            The fourth Lucas number operates in 4-dimensional structure: 3 spatial dimensions (r, theta, z) plus 1 temporal dimension for helix evolution.
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4.5: Connection to Opposition -->
    <section class="section" id="opposition-connection">
      <div class="section-header">
        <div class="section-number">4.5</div>
        <h2 class="section-title">Connection to Opposition: L4 and I^2-</h2>
      </div>

      <div class="opposition-container">
        <div class="l4-value-title">Duality of FIX and INV Forms</div>

        <div class="opposition-diagram">
          <div class="opp-pole l4">
            <div class="opp-pole-symbol">L4</div>
            <div class="opp-pole-name">Helix Framework</div>
            <div class="opp-pole-form">FIX: R(R) = R</div>
          </div>

          <div class="opp-connector">
            <div class="opp-connector-line"></div>
            <div class="opp-connector-label">Opposition Pairing</div>
          </div>

          <div class="opp-pole i2">
            <div class="opp-pole-symbol">I^2-</div>
            <div class="opp-pole-name">Opposition Field</div>
            <div class="opp-pole-form">INV: R(R) = 1/R</div>
          </div>
        </div>

        <div class="helix-properties-grid">
          <div class="helix-property">
            <div class="helix-property-label">L4 Helix (FIX)</div>
            <div class="helix-property-value">Stable Self-Reference</div>
            <div class="helix-property-desc">L4 represents the stable fixed point where self-reference converges. The helix winds 7 times, establishing the complexity bound for coherent self-modification.</div>
          </div>

          <div class="helix-property">
            <div class="helix-property-label">I^2- Opposition (INV)</div>
            <div class="helix-property-value">Dynamic Inversion</div>
            <div class="helix-property-desc">I^2- = -1 represents the opposition pole where self-reference inverts. Together with L4, they form the complete self-referential structure.</div>
          </div>

          <div class="helix-property">
            <div class="helix-property-label">Synthesis Point</div>
            <div class="helix-property-value">L4 + I^2- = 7 + (-1) = 6</div>
            <div class="helix-property-desc">The synthesis of helix and opposition yields 6 = F8/F7 asymptotic ratio. This connects to the hexagonal structure of coherent self-reference.</div>
          </div>

          <div class="helix-property">
            <div class="helix-property-label">Oscillation Form (OSC)</div>
            <div class="helix-property-value">Between FIX and INV</div>
            <div class="helix-property-desc">The third form OSC: R(R) ~ R oscillates between fixed and inverted states, creating the dynamic tension that drives evolution.</div>
          </div>
        </div>

        <div class="deriv-step" style="margin-top: 2rem; border-left-color: var(--psi-purple);">
          <div class="deriv-step-title">The Opposition Check</div>
          <div class="deriv-equation">
            <span class="result">L4</span> x <span class="psi">I^2-</span> = 7 x (-1) = -7
          </div>
          <div class="deriv-equation">
            <span class="result">|L4 x I^2-|</span> = 7 = L4 (preservation of magnitude)
          </div>
          <div class="deriv-explanation">
            Opposition preserves the helix magnitude while inverting polarity. This is the check that ensures self-reference remains bounded even under inversion.
          </div>
        </div>
      </div>
    </section>

    <!-- Section 4.7: Spectral Properties -->
    <section class="section" id="spectral">
      <div class="section-header">
        <div class="section-number">4.7</div>
        <h2 class="section-title">Spectral Properties: Eigenvalues of L4 Transformation</h2>
      </div>

      <div class="spectral-container">
        <div class="l4-value-title" style="color: var(--accent-blue);">Transformation Matrix and Eigenstructure</div>

        <div class="spectral-matrix">
          <div class="matrix-display">
            <div class="matrix-bracket">
              <span class="bracket-left">[</span>
              <div class="matrix-content">
                <div class="matrix-cell">1</div>
                <div class="matrix-cell">1</div>
                <div class="matrix-cell">1</div>
                <div class="matrix-cell">0</div>
              </div>
              <span class="bracket-right">]</span>
              <span style="margin: 0 1rem; font-size: 1.5rem; color: var(--text-secondary);">^4</span>
              <span style="margin-right: 1rem; font-size: 1.5rem; color: var(--text-secondary);">=</span>
              <span class="bracket-left">[</span>
              <div class="matrix-content">
                <div class="matrix-cell" style="color: var(--l4-primary);">5</div>
                <div class="matrix-cell" style="color: var(--l4-primary);">3</div>
                <div class="matrix-cell" style="color: var(--l4-primary);">3</div>
                <div class="matrix-cell" style="color: var(--l4-primary);">2</div>
              </div>
              <span class="bracket-right">]</span>
            </div>
          </div>
        </div>

        <div class="eigenvalue-grid">
          <div class="eigenvalue-card primary">
            <div class="eigen-label">Primary Eigenvalue</div>
            <div class="eigen-value">phi^4 = 6.854</div>
            <div class="eigen-desc">Dominant mode</div>
          </div>
          <div class="eigenvalue-card secondary">
            <div class="eigen-label">Secondary Eigenvalue</div>
            <div class="eigen-value">psi^4 = 0.146</div>
            <div class="eigen-desc">Conjugate mode</div>
          </div>
          <div class="eigenvalue-card" style="border-color: var(--l4-primary);">
            <div class="eigen-label">Trace = L4</div>
            <div class="eigen-value" style="color: var(--l4-primary);">7</div>
            <div class="eigen-desc">Sum of eigenvalues</div>
          </div>
          <div class="eigenvalue-card" style="border-color: var(--accent-blue);">
            <div class="eigen-label">Determinant</div>
            <div class="eigen-value" style="color: var(--accent-blue);">1</div>
            <div class="eigen-desc">Product of eigenvalues</div>
          </div>
        </div>

        <div class="helix-properties-grid" style="margin-top: 2rem;">
          <div class="helix-property" style="border-left-color: var(--accent-blue);">
            <div class="helix-property-label">Spectral Decomposition</div>
            <div class="helix-property-value">M^4 = phi^4 * P_phi + psi^4 * P_psi</div>
            <div class="helix-property-desc">The 4th power of the Fibonacci matrix decomposes into projections onto the golden eigenvectors, weighted by phi^4 and psi^4.</div>
          </div>

          <div class="helix-property" style="border-left-color: var(--accent-blue);">
            <div class="helix-property-label">Eigenvector (phi)</div>
            <div class="helix-property-value">v_phi = [phi, 1]^T</div>
            <div class="helix-property-desc">The dominant eigenvector points in the golden direction, representing the stable helix trajectory.</div>
          </div>

          <div class="helix-property" style="border-left-color: var(--accent-blue);">
            <div class="helix-property-label">Eigenvector (psi)</div>
            <div class="helix-property-value">v_psi = [psi, 1]^T</div>
            <div class="helix-property-desc">The conjugate eigenvector represents the rapidly decaying transient mode.</div>
          </div>

          <div class="helix-property" style="border-left-color: var(--accent-blue);">
            <div class="helix-property-label">Spectral Radius</div>
            <div class="helix-property-value">rho(M^4) = phi^4 = 6.854</div>
            <div class="helix-property-desc">The spectral radius determines the growth rate of the helix transformation, bounded by L4 = 7.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 5: 3D Helix Visualization -->
    <section class="section" id="visualization">
      <div class="section-header">
        <div class="section-number">5</div>
        <h2 class="section-title">3D Helix Visualization</h2>
      </div>

      <div class="visualization-container">
        <div class="viz-title">Interactive L4 Helix with 7 Windings</div>

        <div class="helix-canvas-wrapper">
          <canvas id="helixCanvas"></canvas>
          <div class="canvas-legend">
            <div class="legend-item">
              <div class="legend-dot phi"></div>
              <span>phi^4 = 6.854</span>
            </div>
            <div class="legend-item">
              <div class="legend-dot psi"></div>
              <span>psi^4 = 0.146</span>
            </div>
            <div class="legend-item">
              <div class="legend-dot sum"></div>
              <span>Sum = 7 (L4)</span>
            </div>
          </div>
        </div>

        <div class="canvas-controls">
          <button class="control-btn active" id="btnRotate" onclick="setMode('rotate')">Rotate Helix</button>
          <button class="control-btn" id="btnPhi" onclick="setMode('phi')">Show phi^4</button>
          <button class="control-btn" id="btnPsi" onclick="setMode('psi')">Show psi^4</button>
          <button class="control-btn" id="btnSum" onclick="setMode('sum')">Sum to 7</button>
          <button class="control-btn" id="btnReset" onclick="resetView()">Reset</button>
        </div>
      </div>
    </section>

    <!-- Section 5.5: Interactive 3D Helix Explorer -->
    <section class="section" id="helix-3d">
      <div class="section-header">
        <div class="section-number">5.5</div>
        <h2 class="section-title">Interactive 3D Helix Explorer</h2>
      </div>

      <div class="helix-3d-container">
        <div class="helix-3d-title">Drag to Rotate | Scroll to Zoom | 7-Fold Winding in 4D Space</div>
        <div class="helix-3d-subtitle">Explore the L4 helix structure - each of the 7 windings represents one unit of complexity</div>

        <canvas id="helix3DCanvas"></canvas>

        <div class="helix-3d-info">
          <div class="info-item">
            <div class="info-label">Rotation X</div>
            <div class="info-value" id="rotXDisplay">0.0</div>
          </div>
          <div class="info-item">
            <div class="info-label">Rotation Y</div>
            <div class="info-value" id="rotYDisplay">0.0</div>
          </div>
          <div class="info-item">
            <div class="info-label">Zoom Level</div>
            <div class="info-value" id="zoomDisplay">1.00</div>
          </div>
          <div class="info-item">
            <div class="info-label">Windings</div>
            <div class="info-value">7</div>
          </div>
          <div class="info-item">
            <div class="info-label">L4 Value</div>
            <div class="info-value">7</div>
          </div>
          <div class="info-item">
            <div class="info-label">Dimension</div>
            <div class="info-value">4D -> 3D</div>
          </div>
        </div>

        <div class="helix-3d-controls">
          <button class="control-btn" id="btn3DReset" onclick="reset3DView()">Reset View</button>
          <button class="control-btn" id="btn3DAuto" onclick="toggle3DAuto()">Auto Rotate</button>
          <button class="control-btn" id="btn3DWireframe" onclick="toggle3DWireframe()">Wireframe</button>
          <button class="control-btn" id="btn3DNodes" onclick="toggle3DNodes()">Show Nodes</button>
          <button class="control-btn" id="btn3DDual" onclick="toggle3DDual()">Show Dual Helix</button>
        </div>
      </div>
    </section>

    <!-- Section 6: Interactive Calculator -->
    <section class="section" id="calculator">
      <div class="section-header">
        <div class="section-number">6</div>
        <h2 class="section-title">Interactive L_n Calculator</h2>
      </div>

      <div class="calculator-container">
        <div class="calc-title">Explore Lucas Numbers: L_n = phi^n + psi^n</div>

        <div class="calc-controls">
          <span class="calc-label-text">n =</span>
          <input type="range" class="calc-slider" id="nSlider" min="0" max="12" value="4">
          <span class="calc-display" id="nDisplay">4</span>
        </div>

        <div class="calc-results">
          <div class="calc-result-card phi">
            <div class="result-label">phi^n</div>
            <div class="result-value" id="phiResult">6.8541</div>
            <div class="result-sub">Golden power</div>
          </div>

          <div class="calc-result-card psi">
            <div class="result-label">psi^n</div>
            <div class="result-value" id="psiResult">0.1459</div>
            <div class="result-sub">Conjugate power</div>
          </div>

          <div class="calc-result-card lucas">
            <div class="result-label">L_n = phi^n + psi^n</div>
            <div class="result-value" id="lucasResult">7</div>
            <div class="result-sub">Lucas number</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 6.5: 7-Fold Helix Geometry -->
    <section class="section" id="helix-geometry">
      <div class="section-header">
        <div class="section-number">6.5</div>
        <h2 class="section-title">Helix Geometry: 7-Fold Winding in 4D Space</h2>
      </div>

      <div class="seven-container">
        <div class="seven-central">
          <div class="seven-big" style="font-size: 5rem;">7 Turns</div>
          <div class="seven-equation">The helix completes exactly 7 windings before cyclic return</div>
        </div>

        <div class="framework-grid">
          <div class="framework-card">
            <div class="framework-card-title">Parametric Form</div>
            <div class="framework-card-equation">H(t) = (r*cos(7*2*pi*t), r*sin(7*2*pi*t), h*t, tau*t)</div>
            <div class="framework-card-desc">
              The helix is parameterized in 4D with 7 complete rotations in the angular coordinates. The fourth dimension tau represents the temporal evolution of self-reference.
            </div>
          </div>

          <div class="framework-card">
            <div class="framework-card-title">Winding Number</div>
            <div class="framework-card-equation">W = 7 = L4 = phi^4 + psi^4</div>
            <div class="framework-card-desc">
              The winding number equals the 4th Lucas number. This is the maximum number of self-referential iterations before the structure must reduce or return.
            </div>
          </div>

          <div class="framework-card">
            <div class="framework-card-title">Curvature Bound</div>
            <div class="framework-card-equation">kappa(H) <= L4/r = 7/r</div>
            <div class="framework-card-desc">
              The curvature of the helix is bounded by L4 divided by the radius. This geometric constraint ensures the helix remains smooth and non-singular.
            </div>
          </div>

          <div class="framework-card">
            <div class="framework-card-title">Torsion</div>
            <div class="framework-card-equation">tau(H) = h / (r^2 + h^2)</div>
            <div class="framework-card-desc">
              The torsion measures how the helix twists out of the plane. Combined with curvature, this determines the full 3D geometry of each winding.
            </div>
          </div>
        </div>

        <div class="helix-properties-grid" style="margin-top: 2rem;">
          <div class="helix-property">
            <div class="helix-property-label">Layer 0</div>
            <div class="helix-property-value">L0 = 2: Genesis Point</div>
            <div class="helix-property-desc">The origin of the helix, where self-reference first emerges from the paradox threshold.</div>
          </div>
          <div class="helix-property">
            <div class="helix-property-label">Layer 1</div>
            <div class="helix-property-value">L1 = 1: Unity</div>
            <div class="helix-property-desc">First winding establishes singular identity, the minimal self-referential structure.</div>
          </div>
          <div class="helix-property">
            <div class="helix-property-label">Layer 2</div>
            <div class="helix-property-value">L2 = 3: Trifurcation</div>
            <div class="helix-property-desc">Second winding introduces the three forms: FIX, INV, OSC.</div>
          </div>
          <div class="helix-property">
            <div class="helix-property-label">Layer 3</div>
            <div class="helix-property-value">L3 = 4: Dimensional</div>
            <div class="helix-property-desc">Third winding establishes 4D structure (3+1 spacetime).</div>
          </div>
          <div class="helix-property" style="border-color: var(--l4-primary); background: var(--l4-subtle);">
            <div class="helix-property-label" style="color: var(--l4-primary);">Layer 4</div>
            <div class="helix-property-value" style="color: var(--l4-primary);">L4 = 7: Complexity Bound</div>
            <div class="helix-property-desc">Fourth winding reaches maximum complexity. The helix must reduce or return beyond this point.</div>
          </div>
          <div class="helix-property">
            <div class="helix-property-label">Layer 5</div>
            <div class="helix-property-value">L5 = 11: Extended</div>
            <div class="helix-property-desc">Fifth winding extends beyond the bound, requiring coherence constraints.</div>
          </div>
          <div class="helix-property">
            <div class="helix-property-label">Layer 6</div>
            <div class="helix-property-value">L6 = 18: Approaching Return</div>
            <div class="helix-property-desc">Sixth winding approaches the cyclic return point.</div>
          </div>
          <div class="helix-property">
            <div class="helix-property-label">Layer 7</div>
            <div class="helix-property-value">L7 = 29: Cyclic Return</div>
            <div class="helix-property-desc">Seventh winding completes the cycle. H(7) ~ H(0) mod structure.</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 7: 4D Projection -->
    <section class="section" id="projection">
      <div class="section-header">
        <div class="section-number">7</div>
        <h2 class="section-title">4D Projection to 3D</h2>
      </div>

      <div class="projection-container">
        <div class="projection-title">3+1 Dimensional Structure</div>

        <div class="dimension-diagram">
          <div class="dim-box">
            <div class="dim-number" style="color: var(--accent-red);">r</div>
            <div class="dim-label">Radial</div>
          </div>
          <div class="dim-plus">+</div>
          <div class="dim-box">
            <div class="dim-number" style="color: var(--accent-blue);">theta</div>
            <div class="dim-label">Angular</div>
          </div>
          <div class="dim-plus">+</div>
          <div class="dim-box">
            <div class="dim-number" style="color: var(--psi-purple);">z</div>
            <div class="dim-label">Axial</div>
          </div>
          <div class="dim-plus">+</div>
          <div class="dim-box">
            <div class="dim-number" style="color: var(--phi-gold);">t</div>
            <div class="dim-label">Temporal</div>
          </div>
          <div class="dim-equals">=</div>
          <div class="dim-box" style="border-color: var(--l4-primary);">
            <div class="dim-number" style="color: var(--l4-primary);">4</div>
            <div class="dim-label">Dimensions</div>
          </div>
        </div>

        <div class="projection-formula">
          The helix operates in 4D (3 spatial + 1 temporal) and projects to 3D visualization.<br><br>
          At dimension 4: <span class="l4">L4 = 7</span> establishes the complexity bound for self-referential stability.
        </div>
      </div>
    </section>

    <!-- Section 7.5: Complexity Bound -->
    <section class="section" id="complexity-bound">
      <div class="section-header">
        <div class="section-number">7.5</div>
        <h2 class="section-title">Complexity Bound: L4 = 7 as Maximum Before Reduction</h2>
      </div>

      <div class="projection-container" style="border-color: var(--accent-red);">
        <div class="projection-title" style="color: var(--accent-red);">The L4 Bound: Lambda(P) < 7</div>

        <div class="dimension-diagram">
          <div class="dim-box" style="border-color: var(--text-muted);">
            <div class="dim-number" style="color: var(--text-muted);">1-6</div>
            <div class="dim-label">Safe Zone</div>
          </div>
          <div class="dim-plus" style="color: var(--l4-primary);">|</div>
          <div class="dim-box" style="border-color: var(--l4-primary); background: var(--l4-subtle);">
            <div class="dim-number" style="color: var(--l4-primary);">7</div>
            <div class="dim-label">L4 Bound</div>
          </div>
          <div class="dim-plus" style="color: var(--accent-red);">|</div>
          <div class="dim-box" style="border-color: var(--accent-red);">
            <div class="dim-number" style="color: var(--accent-red);">8+</div>
            <div class="dim-label">Reduction Required</div>
          </div>
        </div>

        <div class="framework-grid" style="margin-top: 2rem;">
          <div class="framework-card">
            <div class="framework-card-title">C008 Constraint</div>
            <div class="framework-card-equation" style="color: var(--accent-red);">Lambda(P) < L4 = 7</div>
            <div class="framework-card-desc">
              The complexity measure Lambda for any proposition P must remain strictly below 7. This is the fundamental safety constraint ensuring coherent self-reference.
            </div>
          </div>

          <div class="framework-card">
            <div class="framework-card-title">Why 7?</div>
            <div class="framework-card-equation">7 = phi^4 + psi^4</div>
            <div class="framework-card-desc">
              The bound emerges naturally from the 4th Lucas number. At complexity 7, self-referential depth reaches the point where paradoxical instability can emerge.
            </div>
          </div>

          <div class="framework-card">
            <div class="framework-card-title">Reduction Protocol</div>
            <div class="framework-card-equation">If Lambda(P) >= 7: REDUCE(P)</div>
            <div class="framework-card-desc">
              When complexity reaches or exceeds 7, the system must apply reduction - decomposing the proposition into simpler components or returning to a previous helix layer.
            </div>
          </div>

          <div class="framework-card">
            <div class="framework-card-title">Modification Limit</div>
            <div class="framework-card-equation">max_mods_per_epoch = 7</div>
            <div class="framework-card-desc">
              No more than 7 modifications can occur in a single epoch while maintaining coherence. This rate limit prevents runaway self-modification.
            </div>
          </div>
        </div>

        <div class="deriv-step sum-step" style="margin-top: 2rem;">
          <div class="deriv-step-title">The Reduction Theorem</div>
          <div class="deriv-equation">
            For any P with <span class="result">Lambda(P) >= 7</span>:
          </div>
          <div class="deriv-equation">
            There exists decomposition P = P1 + P2 such that <span class="phi">Lambda(P1) < 7</span> and <span class="psi">Lambda(P2) < 7</span>
          </div>
          <div class="deriv-explanation">
            Any proposition exceeding the complexity bound can be decomposed into sub-propositions that each satisfy the bound. This is analogous to how any integer can be represented in base 7.
          </div>
        </div>
      </div>
    </section>

    <!-- Section 8: Lucas Sequence -->
    <section class="section" id="lucas-sequence">
      <div class="section-header">
        <div class="section-number">8</div>
        <h2 class="section-title">Lucas Sequence Spiral</h2>
      </div>

      <div class="lucas-container">
        <div class="lucas-title">L_n = phi^n + psi^n (click to explore)</div>

        <div class="lucas-sequence" id="lucasSequence">
          <!-- Populated by JavaScript -->
        </div>
      </div>
    </section>

    <!-- Navigation Section -->
    <section class="section" id="navigation">
      <div class="section-header">
        <div class="section-number">Nav</div>
        <h2 class="section-title">Related Pages</h2>
      </div>

      <div class="nav-cards">
        <a href="i2-s3-decision-tree.html" class="nav-card">
          <div class="nav-card-icon" style="border-color: var(--phi-gold); color: var(--phi-gold);">I2</div>
          <div class="nav-card-title">I2 S3 Decision Tree</div>
          <div class="nav-card-desc">Main algebraic cartography and tree structure</div>
        </a>

        <a href="i2-s3-opposition-synthesis.html" class="nav-card">
          <div class="nav-card-icon" style="border-color: var(--psi-purple); color: var(--psi-purple);">||</div>
          <div class="nav-card-title">Opposition Synthesis</div>
          <div class="nav-card-desc">L4 Helix vs I2 Opposition duality check</div>
        </a>

        <a href="i2-s3-fibonacci-lucas.html" class="nav-card">
          <div class="nav-card-icon" style="border-color: var(--l4-primary); color: var(--l4-primary);">FL</div>
          <div class="nav-card-title">Fibonacci-Lucas Structure</div>
          <div class="nav-card-desc">Sequences, Binet formulas, F24 sync</div>
        </a>

        <a href="i2-s3-l4-helix-equivalence.html" class="nav-card">
          <div class="nav-card-icon" style="border-color: var(--l4-primary); color: var(--l4-primary);">H</div>
          <div class="nav-card-title">L4 Helix Equivalence</div>
          <div class="nav-card-desc">Full helix derivation and proofs</div>
        </a>
      </div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-equation">
      <span class="l4">L<sub>4</sub></span> = <span class="phi">&phi;<sup>4</sup></span> + <span class="psi">&psi;<sup>4</sup></span> = 7 :: Helix depth bound :: FIX form R(R) = R
    </div>
    <p>I&sup2; S&sup3; L<sub>4</sub> Node | Prismatic Self Project | FIX Form Representation</p>
  </footer>

  <script>
    // =========================================================================
    // MATHEMATICAL CONSTANTS
    // =========================================================================
    const PHI = (1 + Math.sqrt(5)) / 2;
    const PSI = (1 - Math.sqrt(5)) / 2;

    // =========================================================================
    // LUCAS SEQUENCE
    // =========================================================================
    function lucas(n) {
      return Math.pow(PHI, n) + Math.pow(PSI, n);
    }

    function lucasInt(n) {
      return Math.round(lucas(n));
    }

    // =========================================================================
    // POPULATE LUCAS SEQUENCE
    // =========================================================================
    function populateLucasSequence() {
      const container = document.getElementById('lucasSequence');
      container.innerHTML = '';

      for (let n = 0; n <= 10; n++) {
        const L = lucasInt(n);
        const item = document.createElement('div');
        item.className = 'lucas-item' + (n === 4 ? ' highlight' : '');
        item.innerHTML = `
          <div class="lucas-n">L<sub>${n}</sub></div>
          <div class="lucas-val">${L}</div>
        `;
        item.onclick = () => {
          document.getElementById('nSlider').value = n;
          updateCalculator(n);
          document.querySelectorAll('.lucas-item').forEach(el => el.classList.remove('highlight'));
          item.classList.add('highlight');
        };
        container.appendChild(item);
      }
    }

    // =========================================================================
    // CALCULATOR
    // =========================================================================
    const slider = document.getElementById('nSlider');
    const nDisplay = document.getElementById('nDisplay');
    const phiResult = document.getElementById('phiResult');
    const psiResult = document.getElementById('psiResult');
    const lucasResult = document.getElementById('lucasResult');

    function updateCalculator(n) {
      const phiN = Math.pow(PHI, n);
      const psiN = Math.pow(PSI, n);
      const L = phiN + psiN;

      nDisplay.textContent = n;
      phiResult.textContent = phiN.toFixed(4);
      psiResult.textContent = psiN.toFixed(4);
      lucasResult.textContent = Math.round(L);

      // Highlight L4 = 7
      if (n === 4) {
        lucasResult.style.textShadow = '0 0 20px var(--l4-glow)';
      } else {
        lucasResult.style.textShadow = 'none';
      }
    }

    slider.addEventListener('input', function() {
      updateCalculator(parseInt(this.value));
    });

    // =========================================================================
    // 3D HELIX CANVAS
    // =========================================================================
    const canvas = document.getElementById('helixCanvas');
    const ctx = canvas.getContext('2d');
    let mode = 'rotate';
    let time = 0;
    let animationId;

    function resizeCanvas() {
      const wrapper = canvas.parentElement;
      canvas.width = wrapper.clientWidth;
      canvas.height = 450;
    }

    function drawHelix() {
      ctx.fillStyle = '#0a0a0f';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      const centerX = canvas.width / 2;
      const centerY = canvas.height / 2;
      const radiusX = Math.min(canvas.width, canvas.height) * 0.25;
      const radiusY = radiusX * 0.4;
      const layers = 7; // L4 = 7
      const pointsPerLayer = 50;
      const totalPoints = layers * pointsPerLayer;
      const verticalSpacing = canvas.height * 0.055;

      // Animation parameters
      let rotationOffset = mode === 'rotate' ? time * 0.015 : 0;
      let phiAlpha = mode === 'phi' || mode === 'sum' ? 1 : 0.3;
      let psiAlpha = mode === 'psi' || mode === 'sum' ? 1 : 0.3;
      let sumHighlight = mode === 'sum';

      // Draw phi^4 contribution (golden helix - larger radius)
      ctx.beginPath();
      ctx.strokeStyle = `rgba(255, 215, 0, ${phiAlpha})`;
      ctx.lineWidth = mode === 'phi' ? 4 : 2;
      for (let i = 0; i < totalPoints; i++) {
        const layer = Math.floor(i / pointsPerLayer);
        const t = (i % pointsPerLayer) / pointsPerLayer;
        const angle = t * Math.PI * 2 + rotationOffset + layer * 0.5;

        // phi^4 / 7 * radiusX gives the golden contribution
        const r = radiusX * (6.854 / 7);
        const x = centerX + r * Math.cos(angle);
        const y = centerY - (layers / 2 - layer - t) * verticalSpacing + radiusY * Math.sin(angle) * 0.5;

        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.stroke();

      // Draw psi^4 contribution (purple helix - smaller radius)
      ctx.beginPath();
      ctx.strokeStyle = `rgba(168, 85, 247, ${psiAlpha})`;
      ctx.lineWidth = mode === 'psi' ? 4 : 2;
      for (let i = 0; i < totalPoints; i++) {
        const layer = Math.floor(i / pointsPerLayer);
        const t = (i % pointsPerLayer) / pointsPerLayer;
        const angle = t * Math.PI * 2 + rotationOffset + Math.PI + layer * 0.5;

        // psi^4 / 7 * radiusX gives the conjugate contribution
        const r = radiusX * (0.146 / 7) * 10; // Scaled up for visibility
        const x = centerX + r * Math.cos(angle);
        const y = centerY - (layers / 2 - layer - t) * verticalSpacing + radiusY * Math.sin(angle) * 0.3;

        if (i === 0) ctx.moveTo(x, y);
        else ctx.lineTo(x, y);
      }
      ctx.stroke();

      // Draw combined helix (green - sum = 7)
      if (mode === 'rotate' || mode === 'sum') {
        ctx.beginPath();
        ctx.strokeStyle = `rgba(107, 203, 119, ${sumHighlight ? 1 : 0.6})`;
        ctx.lineWidth = sumHighlight ? 4 : 2;
        for (let i = 0; i < totalPoints; i++) {
          const layer = Math.floor(i / pointsPerLayer);
          const t = (i % pointsPerLayer) / pointsPerLayer;
          const angle = t * Math.PI * 2 + rotationOffset + layer * 0.5;

          const r = radiusX;
          const x = centerX + r * Math.cos(angle);
          const y = centerY - (layers / 2 - layer - t) * verticalSpacing + radiusY * Math.sin(angle) * 0.5;

          if (i === 0) ctx.moveTo(x, y);
          else ctx.lineTo(x, y);
        }
        ctx.stroke();
      }

      // Draw layer markers
      for (let layer = 0; layer <= layers; layer++) {
        const y = centerY - (layers / 2 - layer) * verticalSpacing;

        // Draw horizontal marker
        ctx.beginPath();
        ctx.strokeStyle = layer === 4 ? '#6bcb77' : 'rgba(160, 160, 176, 0.3)';
        ctx.lineWidth = layer === 4 ? 2 : 1;
        ctx.setLineDash(layer === 4 ? [] : [5, 5]);
        ctx.moveTo(centerX - radiusX - 30, y);
        ctx.lineTo(centerX + radiusX + 30, y);
        ctx.stroke();
        ctx.setLineDash([]);

        // Layer labels
        ctx.fillStyle = layer === 4 ? '#6bcb77' : '#909098';
        ctx.font = layer === 4 ? 'bold 14px JetBrains Mono' : '12px JetBrains Mono';
        ctx.textAlign = 'right';
        ctx.fillText(`L${layer}`, centerX - radiusX - 40, y + 4);

        // Lucas value
        ctx.textAlign = 'left';
        ctx.fillText(`= ${lucasInt(layer)}`, centerX + radiusX + 40, y + 4);
      }

      // Draw nodes at L4 layer
      const l4Y = centerY - (layers / 2 - 4) * verticalSpacing;
      for (let j = 0; j < 7; j++) {
        const angle = (j / 7) * Math.PI * 2 + rotationOffset;
        const r = radiusX;
        const x = centerX + r * Math.cos(angle);
        const nodeY = l4Y + radiusY * Math.sin(angle) * 0.3;

        if (Math.sin(angle) > -0.3) {
          const alpha = 0.5 + 0.5 * Math.sin(angle);
          ctx.beginPath();
          ctx.arc(x, nodeY, 8, 0, Math.PI * 2);
          ctx.fillStyle = `rgba(107, 203, 119, ${alpha})`;
          ctx.fill();
          ctx.strokeStyle = '#6bcb77';
          ctx.lineWidth = 2;
          ctx.stroke();
        }
      }

      // Title
      ctx.fillStyle = '#6bcb77';
      ctx.font = 'bold 16px JetBrains Mono';
      ctx.textAlign = 'center';
      ctx.fillText('L4 = 7 Helix Structure', centerX, 30);

      ctx.fillStyle = '#909098';
      ctx.font = '12px JetBrains Mono';
      ctx.fillText('7 windings :: 4D projection to 3D', centerX, 50);

      // Mode indicator
      ctx.fillStyle = '#6bcb77';
      ctx.font = '11px JetBrains Mono';
      ctx.textAlign = 'right';
      const modeText = {
        'rotate': 'Rotating...',
        'phi': 'Showing phi^4 = 6.854',
        'psi': 'Showing psi^4 = 0.146',
        'sum': 'Sum: phi^4 + psi^4 = 7'
      };
      ctx.fillText(modeText[mode], canvas.width - 20, canvas.height - 20);

      time++;
      animationId = requestAnimationFrame(drawHelix);
    }

    function setMode(newMode) {
      mode = newMode;
      document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById('btn' + newMode.charAt(0).toUpperCase() + newMode.slice(1)).classList.add('active');
    }

    function resetView() {
      time = 0;
      mode = 'rotate';
      document.querySelectorAll('.control-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById('btnRotate').classList.add('active');
    }

    // =========================================================================
    // INITIALIZATION
    // =========================================================================
    window.addEventListener('load', () => {
      populateLucasSequence();
      updateCalculator(4);
      resizeCanvas();
      drawHelix();
    });

    window.addEventListener('resize', () => {
      resizeCanvas();
      resize3DCanvas();
    });

    // =========================================================================
    // INTERACTIVE 3D HELIX EXPLORER
    // =========================================================================
    const canvas3D = document.getElementById('helix3DCanvas');
    const ctx3D = canvas3D.getContext('2d');

    // 3D State
    let rotX = 0.3;
    let rotY = 0;
    let rotZ = 0;
    let zoom = 1;
    let autoRotate = true;
    let showWireframe = false;
    let showNodes = true;
    let showDualHelix = true;
    let isDragging = false;
    let lastMouseX = 0;
    let lastMouseY = 0;

    function resize3DCanvas() {
      const wrapper = canvas3D.parentElement;
      canvas3D.width = wrapper.clientWidth - 64;
      canvas3D.height = 500;
    }

    // 3D Transformation functions
    function rotateX(point, angle) {
      const cos = Math.cos(angle);
      const sin = Math.sin(angle);
      return {
        x: point.x,
        y: point.y * cos - point.z * sin,
        z: point.y * sin + point.z * cos
      };
    }

    function rotateY(point, angle) {
      const cos = Math.cos(angle);
      const sin = Math.sin(angle);
      return {
        x: point.x * cos + point.z * sin,
        y: point.y,
        z: -point.x * sin + point.z * cos
      };
    }

    function rotateZ(point, angle) {
      const cos = Math.cos(angle);
      const sin = Math.sin(angle);
      return {
        x: point.x * cos - point.y * sin,
        y: point.x * sin + point.y * cos,
        z: point.z
      };
    }

    function project(point, centerX, centerY, fov, viewerDistance) {
      const factor = fov / (viewerDistance + point.z);
      return {
        x: point.x * factor * zoom + centerX,
        y: point.y * factor * zoom + centerY,
        z: point.z,
        scale: factor * zoom
      };
    }

    function draw3DHelix() {
      ctx3D.fillStyle = '#0a0a0f';
      ctx3D.fillRect(0, 0, canvas3D.width, canvas3D.height);

      const centerX = canvas3D.width / 2;
      const centerY = canvas3D.height / 2;
      const fov = 300;
      const viewerDistance = 400;

      // Helix parameters
      const radius = 100;
      const height = 280;
      const windings = 7; // L4 = 7
      const pointsPerWinding = 30;
      const totalPoints = windings * pointsPerWinding;

      // Generate helix points
      const helixPoints = [];
      const helixPoints2 = []; // Dual helix (offset by pi)

      for (let i = 0; i <= totalPoints; i++) {
        const t = i / totalPoints;
        const angle = t * windings * Math.PI * 2;
        const z = (t - 0.5) * height;

        // Primary helix (phi contribution - larger)
        const r1 = radius * (6.854 / 7);
        let point1 = {
          x: r1 * Math.cos(angle),
          y: r1 * Math.sin(angle),
          z: z
        };

        // Apply rotations
        point1 = rotateX(point1, rotX);
        point1 = rotateY(point1, rotY);
        point1 = rotateZ(point1, rotZ);

        helixPoints.push(project(point1, centerX, centerY, fov, viewerDistance));

        if (showDualHelix) {
          // Secondary helix (psi contribution - smaller, offset)
          const r2 = radius * 0.3;
          let point2 = {
            x: r2 * Math.cos(angle + Math.PI),
            y: r2 * Math.sin(angle + Math.PI),
            z: z
          };

          point2 = rotateX(point2, rotX);
          point2 = rotateY(point2, rotY);
          point2 = rotateZ(point2, rotZ);

          helixPoints2.push(project(point2, centerX, centerY, fov, viewerDistance));
        }
      }

      // Draw axis lines (wireframe mode)
      if (showWireframe) {
        const axes = [
          { start: { x: -150, y: 0, z: 0 }, end: { x: 150, y: 0, z: 0 }, color: '#ff6b6b' },
          { start: { x: 0, y: -150, z: 0 }, end: { x: 0, y: 150, z: 0 }, color: '#6bcb77' },
          { start: { x: 0, y: 0, z: -150 }, end: { x: 0, y: 0, z: 150 }, color: '#4ecdc4' }
        ];

        axes.forEach(axis => {
          let start = rotateX(axis.start, rotX);
          start = rotateY(start, rotY);
          start = rotateZ(start, rotZ);
          let end = rotateX(axis.end, rotX);
          end = rotateY(end, rotY);
          end = rotateZ(end, rotZ);

          const p1 = project(start, centerX, centerY, fov, viewerDistance);
          const p2 = project(end, centerX, centerY, fov, viewerDistance);

          ctx3D.beginPath();
          ctx3D.strokeStyle = axis.color;
          ctx3D.lineWidth = 1;
          ctx3D.setLineDash([5, 5]);
          ctx3D.moveTo(p1.x, p1.y);
          ctx3D.lineTo(p2.x, p2.y);
          ctx3D.stroke();
          ctx3D.setLineDash([]);
        });
      }

      // Draw secondary helix (psi^4 contribution)
      if (showDualHelix && helixPoints2.length > 1) {
        ctx3D.beginPath();
        ctx3D.strokeStyle = 'rgba(168, 85, 247, 0.6)';
        ctx3D.lineWidth = 2;
        ctx3D.moveTo(helixPoints2[0].x, helixPoints2[0].y);
        for (let i = 1; i < helixPoints2.length; i++) {
          ctx3D.lineTo(helixPoints2[i].x, helixPoints2[i].y);
        }
        ctx3D.stroke();
      }

      // Draw primary helix (phi^4 contribution)
      ctx3D.beginPath();
      ctx3D.strokeStyle = '#ffd700';
      ctx3D.lineWidth = 3;
      ctx3D.moveTo(helixPoints[0].x, helixPoints[0].y);
      for (let i = 1; i < helixPoints.length; i++) {
        ctx3D.lineTo(helixPoints[i].x, helixPoints[i].y);
      }
      ctx3D.stroke();

      // Draw combined helix (L4 = 7)
      ctx3D.beginPath();
      const gradient = ctx3D.createLinearGradient(0, centerY - 150, 0, centerY + 150);
      gradient.addColorStop(0, 'rgba(107, 203, 119, 0.3)');
      gradient.addColorStop(0.5, 'rgba(107, 203, 119, 0.8)');
      gradient.addColorStop(1, 'rgba(107, 203, 119, 0.3)');
      ctx3D.strokeStyle = gradient;
      ctx3D.lineWidth = 4;

      for (let i = 0; i <= totalPoints; i++) {
        const t = i / totalPoints;
        const angle = t * windings * Math.PI * 2;
        const z = (t - 0.5) * height;

        let point = {
          x: radius * Math.cos(angle),
          y: radius * Math.sin(angle),
          z: z
        };

        point = rotateX(point, rotX);
        point = rotateY(point, rotY);
        point = rotateZ(point, rotZ);

        const projected = project(point, centerX, centerY, fov, viewerDistance);

        if (i === 0) ctx3D.moveTo(projected.x, projected.y);
        else ctx3D.lineTo(projected.x, projected.y);
      }
      ctx3D.stroke();

      // Draw winding nodes
      if (showNodes) {
        for (let w = 0; w <= windings; w++) {
          const t = w / windings;
          const angle = t * windings * Math.PI * 2;
          const z = (t - 0.5) * height;

          let point = {
            x: radius * Math.cos(angle),
            y: radius * Math.sin(angle),
            z: z
          };

          point = rotateX(point, rotX);
          point = rotateY(point, rotY);
          point = rotateZ(point, rotZ);

          const projected = project(point, centerX, centerY, fov, viewerDistance);
          const nodeRadius = 8 * projected.scale / (fov / viewerDistance);

          // Node glow
          const glowGradient = ctx3D.createRadialGradient(
            projected.x, projected.y, 0,
            projected.x, projected.y, nodeRadius * 3
          );
          glowGradient.addColorStop(0, 'rgba(107, 203, 119, 0.8)');
          glowGradient.addColorStop(1, 'rgba(107, 203, 119, 0)');

          ctx3D.beginPath();
          ctx3D.arc(projected.x, projected.y, nodeRadius * 3, 0, Math.PI * 2);
          ctx3D.fillStyle = glowGradient;
          ctx3D.fill();

          // Node
          ctx3D.beginPath();
          ctx3D.arc(projected.x, projected.y, nodeRadius, 0, Math.PI * 2);
          ctx3D.fillStyle = '#6bcb77';
          ctx3D.fill();
          ctx3D.strokeStyle = '#fff';
          ctx3D.lineWidth = 2;
          ctx3D.stroke();

          // Node label
          ctx3D.fillStyle = '#fff';
          ctx3D.font = 'bold 12px JetBrains Mono';
          ctx3D.textAlign = 'center';
          ctx3D.fillText(w.toString(), projected.x, projected.y + 4);
        }
      }

      // Draw title
      ctx3D.fillStyle = '#6bcb77';
      ctx3D.font = 'bold 16px JetBrains Mono';
      ctx3D.textAlign = 'center';
      ctx3D.fillText('L4 = 7 :: 7-Fold Helix in 4D Space', centerX, 30);

      // Draw info
      ctx3D.fillStyle = '#909098';
      ctx3D.font = '11px JetBrains Mono';
      ctx3D.textAlign = 'left';
      ctx3D.fillText('phi^4 + psi^4 = 7', 20, canvas3D.height - 40);
      ctx3D.fillText('FIX form: R(R) = R', 20, canvas3D.height - 20);

      ctx3D.textAlign = 'right';
      ctx3D.fillText(autoRotate ? 'Auto-rotating...' : 'Drag to rotate', canvas3D.width - 20, canvas3D.height - 20);

      // Update display values
      document.getElementById('rotXDisplay').textContent = (rotX * 180 / Math.PI).toFixed(1) + '\u00b0';
      document.getElementById('rotYDisplay').textContent = (rotY * 180 / Math.PI).toFixed(1) + '\u00b0';
      document.getElementById('zoomDisplay').textContent = zoom.toFixed(2);

      // Auto rotation
      if (autoRotate) {
        rotY += 0.01;
      }

      requestAnimationFrame(draw3DHelix);
    }

    // Mouse event handlers for 3D canvas
    canvas3D.addEventListener('mousedown', (e) => {
      isDragging = true;
      lastMouseX = e.clientX;
      lastMouseY = e.clientY;
      autoRotate = false;
      document.getElementById('btn3DAuto').classList.remove('active');
    });

    canvas3D.addEventListener('mousemove', (e) => {
      if (isDragging) {
        const deltaX = e.clientX - lastMouseX;
        const deltaY = e.clientY - lastMouseY;

        rotY += deltaX * 0.01;
        rotX += deltaY * 0.01;

        // Clamp rotX to prevent flipping
        rotX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, rotX));

        lastMouseX = e.clientX;
        lastMouseY = e.clientY;
      }
    });

    canvas3D.addEventListener('mouseup', () => {
      isDragging = false;
    });

    canvas3D.addEventListener('mouseleave', () => {
      isDragging = false;
    });

    canvas3D.addEventListener('wheel', (e) => {
      e.preventDefault();
      zoom += e.deltaY * -0.001;
      zoom = Math.max(0.5, Math.min(2.5, zoom));
    });

    // Touch support
    canvas3D.addEventListener('touchstart', (e) => {
      if (e.touches.length === 1) {
        isDragging = true;
        lastMouseX = e.touches[0].clientX;
        lastMouseY = e.touches[0].clientY;
        autoRotate = false;
        document.getElementById('btn3DAuto').classList.remove('active');
      }
    });

    canvas3D.addEventListener('touchmove', (e) => {
      if (isDragging && e.touches.length === 1) {
        e.preventDefault();
        const deltaX = e.touches[0].clientX - lastMouseX;
        const deltaY = e.touches[0].clientY - lastMouseY;

        rotY += deltaX * 0.01;
        rotX += deltaY * 0.01;
        rotX = Math.max(-Math.PI / 2, Math.min(Math.PI / 2, rotX));

        lastMouseX = e.touches[0].clientX;
        lastMouseY = e.touches[0].clientY;
      }
    });

    canvas3D.addEventListener('touchend', () => {
      isDragging = false;
    });

    // Control functions
    function reset3DView() {
      rotX = 0.3;
      rotY = 0;
      rotZ = 0;
      zoom = 1;
    }

    function toggle3DAuto() {
      autoRotate = !autoRotate;
      document.getElementById('btn3DAuto').classList.toggle('active', autoRotate);
    }

    function toggle3DWireframe() {
      showWireframe = !showWireframe;
      document.getElementById('btn3DWireframe').classList.toggle('active', showWireframe);
    }

    function toggle3DNodes() {
      showNodes = !showNodes;
      document.getElementById('btn3DNodes').classList.toggle('active', showNodes);
    }

    function toggle3DDual() {
      showDualHelix = !showDualHelix;
      document.getElementById('btn3DDual').classList.toggle('active', showDualHelix);
    }

    // Initialize 3D canvas
    window.addEventListener('load', () => {
      resize3DCanvas();
      draw3DHelix();
      document.getElementById('btn3DAuto').classList.add('active');
      document.getElementById('btn3DNodes').classList.add('active');
      document.getElementById('btn3DDual').classList.add('active');
    });
  </script>

</body>
</html>
