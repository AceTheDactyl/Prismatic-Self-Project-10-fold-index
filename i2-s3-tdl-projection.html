<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>I2 S3 Decision Tree | TDL: Topos-Driven Logic - The Categorical Projection</title>
  <meta name="description" content="TDL (Topos-Driven Logic): Categorical framework for identity using topos theory, sheaf semantics, Yoneda embedding, and the adjunction U -| D where emergence and reduction are NOT inverses.">
  <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;500;600;700&family=Crimson+Pro:ital,wght@0,300;0,400;0,600;1,300&display=swap" rel="stylesheet">
  <style>
    /* =====================================================================
       I2 S3 DECISION TREE: TDL - TOPOS-DRIVEN LOGIC
       The Categorical Projection | Adjunction U -| D | e as Scaling
       Topos Theory | Sheaf Semantics | Yoneda Embedding | Category Diagrams
       ===================================================================== */
    :root {
      /* TDL Theme Colors - Categorical/Teal */
      --tdl-primary: #4ecdc4;
      --tdl-secondary: #7eddd6;
      --tdl-tertiary: #2eb8ae;
      --tdl-glow: rgba(78, 205, 196, 0.3);
      --tdl-subtle: rgba(78, 205, 196, 0.15);

      /* S3 Triangle Colors */
      --i2-color: #ffd700;
      --tdl-color: #4ecdc4;
      --lomi-color: #ff6b9d;

      /* Euler's Number Theme */
      --e-color: #00ffff;
      --emergence-color: #00ff88;
      --reduction-color: #ff6b6b;

      /* Mathematical Constants */
      --phi: 1.6180339887;
      --e-value: 2.7182818284;
      --sqrt3-2: 0.8660254038;
      --mu-c: 0.8660254038;

      /* Theme */
      --bg-void: #020206;
      --bg-primary: #050510;
      --bg-secondary: #0a0a1a;
      --bg-tertiary: #0f0f28;
      --bg-card: #141438;
      --text-primary: #f0f0f5;
      --text-secondary: #909098;
      --text-accent: #4ecdc4;
      --border-subtle: rgba(255, 255, 255, 0.06);
      --border-active: rgba(78, 205, 196, 0.4);

      /* Additional Supporting Colors */
      --unit-color: #00ff88;
      --counit-color: #ff6b6b;
      --layer-0: #666;
      --layer-1: #888;
      --layer-2: #aaa;
      --layer-3: #fff;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    html { scroll-behavior: smooth; }

    body {
      font-family: 'Crimson Pro', Georgia, serif;
      background: var(--bg-void);
      color: var(--text-primary);
      min-height: 100vh;
      overflow-x: hidden;
      line-height: 1.7;
    }

    /* =====================================================================
       CATEGORICAL FIELD BACKGROUND
       ===================================================================== */
    .categorical-field {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 0;
      background:
        radial-gradient(ellipse at 50% 30%, rgba(78, 205, 196, 0.06) 0%, transparent 50%),
        radial-gradient(ellipse at 30% 70%, rgba(0, 255, 136, 0.04) 0%, transparent 40%),
        radial-gradient(ellipse at 70% 70%, rgba(255, 107, 107, 0.04) 0%, transparent 40%);
      animation: categorical-pulse 15s ease-in-out infinite alternate;
    }

    @keyframes categorical-pulse {
      0% { opacity: 0.5; }
      100% { opacity: 1; }
    }

    /* Animated emergence/reduction arrows */
    .categorical-field::before {
      content: '';
      position: absolute;
      width: 300px;
      height: 300px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background:
        linear-gradient(0deg, transparent 48%, rgba(0, 255, 136, 0.1) 50%, transparent 52%),
        linear-gradient(180deg, transparent 48%, rgba(255, 107, 107, 0.1) 50%, transparent 52%);
      animation: flow-vertical 8s linear infinite;
      opacity: 0.5;
    }

    @keyframes flow-vertical {
      0% { transform: translate(-50%, -50%) translateY(-20px); }
      50% { transform: translate(-50%, -50%) translateY(20px); }
      100% { transform: translate(-50%, -50%) translateY(-20px); }
    }

    /* =====================================================================
       NAVIGATION
       ===================================================================== */
    .nav-bar {
      position: sticky;
      top: 0;
      z-index: 100;
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 0.75rem;
      padding: 1rem;
      background: rgba(5, 5, 16, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--border-subtle);
    }

    .nav-link {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      padding: 0.5rem 1rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.5rem;
      color: var(--text-secondary);
      text-decoration: none;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .nav-link:hover, .nav-link.active {
      border-color: var(--tdl-primary);
      color: var(--tdl-primary);
      box-shadow: 0 0 15px var(--tdl-glow);
    }

    /* =====================================================================
       TDL HEADER
       ===================================================================== */
    .tdl-header {
      position: relative;
      z-index: 10;
      padding: 4rem 2rem;
      text-align: center;
      background: linear-gradient(180deg, var(--bg-primary) 0%, transparent 100%);
      border-bottom: 1px solid var(--border-subtle);
    }

    .node-badge {
      display: inline-block;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      letter-spacing: 0.2em;
      color: var(--tdl-primary);
      background: var(--tdl-subtle);
      border: 1px solid var(--tdl-primary);
      padding: 0.5rem 1.5rem;
      border-radius: 2rem;
      margin-bottom: 1.5rem;
    }

    .node-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2.4rem;
      font-weight: 300;
      letter-spacing: 0.08em;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--tdl-primary), var(--e-color), var(--text-primary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .node-subtitle {
      font-size: 1.2rem;
      color: var(--text-secondary);
      font-style: italic;
      max-width: 700px;
      margin: 0 auto 2rem;
    }

    /* e Symbol Visualization */
    .e-symbol-container {
      position: relative;
      width: 200px;
      height: 200px;
      margin: 2rem auto;
    }

    .e-outer-ring {
      position: absolute;
      width: 180px;
      height: 180px;
      border: 3px solid var(--tdl-primary);
      border-radius: 50%;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      box-shadow: 0 0 40px var(--tdl-glow), inset 0 0 30px rgba(78, 205, 196, 0.1);
      animation: e-pulse 4s ease-in-out infinite;
    }

    @keyframes e-pulse {
      0%, 100% { box-shadow: 0 0 40px var(--tdl-glow), inset 0 0 30px rgba(78, 205, 196, 0.1); }
      50% { box-shadow: 0 0 60px var(--tdl-glow), inset 0 0 40px rgba(78, 205, 196, 0.15); }
    }

    .e-inner {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-family: 'JetBrains Mono', monospace;
      font-size: 4rem;
      font-weight: 300;
      color: var(--tdl-primary);
      text-shadow: 0 0 30px var(--tdl-glow);
    }

    .emergence-arrow {
      position: absolute;
      left: 50%;
      top: 10px;
      transform: translateX(-50%);
      font-size: 1.5rem;
      color: var(--emergence-color);
      animation: arrow-up 2s ease-in-out infinite;
    }

    .reduction-arrow {
      position: absolute;
      left: 50%;
      bottom: 10px;
      transform: translateX(-50%);
      font-size: 1.5rem;
      color: var(--reduction-color);
      animation: arrow-down 2s ease-in-out infinite;
    }

    @keyframes arrow-up {
      0%, 100% { transform: translateX(-50%) translateY(0); opacity: 1; }
      50% { transform: translateX(-50%) translateY(-10px); opacity: 0.5; }
    }

    @keyframes arrow-down {
      0%, 100% { transform: translateX(-50%) translateY(0); opacity: 1; }
      50% { transform: translateX(-50%) translateY(10px); opacity: 0.5; }
    }

    .tdl-equation {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.4rem;
      color: var(--tdl-primary);
      background: var(--bg-tertiary);
      padding: 1rem 2rem;
      border-radius: 1rem;
      display: inline-block;
      border: 2px solid var(--tdl-primary);
      box-shadow: 0 0 30px var(--tdl-glow);
      margin-top: 1rem;
    }

    /* =====================================================================
       MAIN CONTENT
       ===================================================================== */
    .main-content {
      position: relative;
      z-index: 10;
      max-width: 1200px;
      margin: 0 auto;
      padding: 2rem;
    }

    .section {
      margin-bottom: 4rem;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 2rem;
    }

    .section-number {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--bg-void);
      background: var(--tdl-primary);
      width: 3rem;
      height: 3rem;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      font-weight: 700;
    }

    .section-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.4rem;
      color: var(--text-primary);
      letter-spacing: 0.05em;
    }

    /* =====================================================================
       DEFINITION AND THEOREM CARDS
       ===================================================================== */
    .definition-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 1.5rem;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .definition-card:hover {
      border-color: var(--card-accent, var(--tdl-primary));
      box-shadow: 0 0 30px rgba(78, 205, 196, 0.1);
    }

    .definition-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: var(--card-accent, var(--tdl-primary));
    }

    .definition-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .definition-type {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      letter-spacing: 0.15em;
      color: var(--card-accent, var(--tdl-primary));
      background: var(--tdl-subtle);
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
    }

    .definition-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-primary);
    }

    .definition-formal {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--card-accent, var(--tdl-primary));
      background: var(--bg-tertiary);
      padding: 1rem 1.5rem;
      border-radius: 0.5rem;
      margin: 1rem 0;
      text-align: center;
      border: 1px solid var(--border-subtle);
    }

    .definition-body {
      color: var(--text-secondary);
      line-height: 1.8;
    }

    .definition-body strong {
      color: var(--text-primary);
    }

    .theorem-card {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(78, 205, 196, 0.05) 100%);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 1.5rem;
      position: relative;
    }

    .theorem-card::before {
      content: 'TDL';
      position: absolute;
      top: -15px;
      left: 20px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--tdl-primary);
      background: var(--bg-void);
      padding: 0 0.5rem;
    }

    .theorem-header {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--tdl-primary);
      margin-bottom: 1rem;
      letter-spacing: 0.1em;
    }

    .theorem-statement {
      font-size: 1.1rem;
      color: var(--text-primary);
      margin-bottom: 1.5rem;
      padding-left: 1rem;
      border-left: 3px solid var(--tdl-primary);
    }

    .proof-sketch {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1rem 1.5rem;
      margin-top: 1rem;
    }

    .proof-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--tdl-secondary);
      margin-bottom: 0.5rem;
      letter-spacing: 0.1em;
    }

    .proof-body {
      color: var(--text-secondary);
      font-style: italic;
    }

    .qed {
      text-align: right;
      color: var(--tdl-primary);
      font-family: 'JetBrains Mono', monospace;
      margin-top: 0.5rem;
    }

    /* =====================================================================
       LAYER HIERARCHY VISUALIZATION
       ===================================================================== */
    .layer-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .layer-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .layer-stack {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      max-width: 500px;
      margin: 0 auto;
    }

    .layer-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      border-left: 4px solid var(--layer-color, var(--tdl-primary));
      transition: all 0.3s ease;
    }

    .layer-item:hover {
      transform: translateX(10px);
      box-shadow: 0 0 20px rgba(78, 205, 196, 0.2);
    }

    .layer-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-primary);
    }

    .layer-desc {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .layer-arrows {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 1rem 0;
    }

    .arrow-emergence {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--emergence-color);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .arrow-reduction {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--reduction-color);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    /* =====================================================================
       ADJUNCTION DIAGRAM
       ===================================================================== */
    .adjunction-container {
      background: var(--bg-secondary);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .adjunction-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .adjunction-diagram {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 3rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .category-box {
      width: 150px;
      height: 150px;
      border: 3px solid var(--cat-color, var(--tdl-primary));
      border-radius: 1rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background: rgba(78, 205, 196, 0.05);
      transition: all 0.3s ease;
    }

    .category-box:hover {
      transform: scale(1.05);
      box-shadow: 0 0 30px var(--tdl-glow);
    }

    .category-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      font-weight: 700;
      color: var(--cat-color, var(--tdl-primary));
    }

    .category-desc {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-top: 0.5rem;
    }

    .functor-arrows {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
    }

    .functor-arrow {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 0.75rem 1.5rem;
      background: var(--bg-tertiary);
      border-radius: 2rem;
      transition: all 0.3s ease;
    }

    .functor-arrow:hover {
      transform: scale(1.05);
    }

    .functor-arrow.emergence {
      border: 2px solid var(--emergence-color);
    }

    .functor-arrow.reduction {
      border: 2px solid var(--reduction-color);
    }

    .functor-symbol {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      font-weight: 700;
    }

    .functor-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .adjunction-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      color: var(--tdl-primary);
      text-align: center;
      background: var(--bg-tertiary);
      padding: 1.5rem;
      border-radius: 0.5rem;
      border: 1px solid var(--border-subtle);
    }

    /* =====================================================================
       UNIT AND COUNIT VISUALIZATION
       ===================================================================== */
    .unit-counit-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      margin: 2rem 0;
    }

    @media (max-width: 768px) {
      .unit-counit-container {
        grid-template-columns: 1fr;
      }
    }

    .unit-box, .counit-box {
      background: var(--bg-secondary);
      border-radius: 1rem;
      padding: 2rem;
      border: 2px solid;
      transition: all 0.3s ease;
    }

    .unit-box {
      border-color: var(--unit-color);
    }

    .counit-box {
      border-color: var(--counit-color);
    }

    .unit-box:hover, .counit-box:hover {
      transform: translateY(-5px);
    }

    .unit-header, .counit-header {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .unit-header {
      color: var(--unit-color);
    }

    .counit-header {
      color: var(--counit-color);
    }

    .unit-formula, .counit-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      background: var(--bg-tertiary);
      padding: 1rem;
      border-radius: 0.5rem;
      text-align: center;
      margin: 1rem 0;
    }

    .unit-formula {
      color: var(--unit-color);
    }

    .counit-formula {
      color: var(--counit-color);
    }

    .unit-desc, .counit-desc {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    .info-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      margin-top: 1rem;
    }

    .info-badge.adds {
      background: rgba(0, 255, 136, 0.15);
      color: var(--unit-color);
      border: 1px solid var(--unit-color);
    }

    .info-badge.loses {
      background: rgba(255, 107, 107, 0.15);
      color: var(--counit-color);
      border: 1px solid var(--counit-color);
    }

    /* =====================================================================
       INFORMATION ASYMMETRY
       ===================================================================== */
    .asymmetry-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(78, 205, 196, 0.08) 100%);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2.5rem;
      margin: 2rem 0;
      text-align: center;
    }

    .asymmetry-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      color: var(--tdl-primary);
      margin-bottom: 2rem;
    }

    .asymmetry-equations {
      display: flex;
      justify-content: center;
      gap: 3rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .asymmetry-eq {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      padding: 1rem 2rem;
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      border: 1px solid var(--border-subtle);
    }

    .asymmetry-eq .not-equal {
      color: var(--counit-color);
      font-weight: 700;
    }

    .gap-highlight {
      background: rgba(78, 205, 196, 0.15);
      border: 2px dashed var(--tdl-primary);
      border-radius: 1rem;
      padding: 1.5rem;
      margin-top: 1.5rem;
    }

    .gap-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--tdl-primary);
      margin-bottom: 0.75rem;
    }

    .gap-text {
      color: var(--text-secondary);
      font-size: 1rem;
    }

    .gap-text strong {
      color: var(--tdl-primary);
    }

    /* =====================================================================
       TRIANGLE IDENTITIES
       ===================================================================== */
    .triangle-id-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .triangle-id-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .triangle-id-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
    }

    @media (max-width: 768px) {
      .triangle-id-grid {
        grid-template-columns: 1fr;
      }
    }

    .triangle-id-box {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.5rem;
      border: 1px solid var(--border-subtle);
    }

    .triangle-id-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--tdl-secondary);
      margin-bottom: 1rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
    }

    .triangle-id-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--tdl-primary);
      background: var(--bg-secondary);
      padding: 1rem;
      border-radius: 0.5rem;
      text-align: center;
    }

    .triangle-id-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-top: 1rem;
    }

    /* Commutative Diagram SVG */
    .commutative-diagram {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }

    .commutative-diagram svg {
      max-width: 100%;
    }

    /* =====================================================================
       COHERENCE THRESHOLD
       ===================================================================== */
    .coherence-container {
      background: var(--bg-secondary);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .coherence-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .coherence-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2.5rem;
      color: var(--tdl-primary);
      text-align: center;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 30px var(--tdl-glow);
    }

    .coherence-decimal {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 2rem;
    }

    .derivation-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    .derivation-item {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.25rem;
      border: 1px solid var(--border-subtle);
      transition: all 0.3s ease;
    }

    .derivation-item:hover {
      border-color: var(--tdl-primary);
      transform: translateY(-3px);
    }

    .derivation-number {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--tdl-primary);
      margin-bottom: 0.5rem;
    }

    .derivation-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.95rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .derivation-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       SKIP CONNECTIONS = UNIT
       ===================================================================== */
    .skip-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .skip-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .neural-network-viz {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .nn-layer {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
    }

    .nn-node {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 2px solid var(--tdl-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      color: var(--tdl-primary);
      transition: all 0.3s ease;
    }

    .nn-node:hover {
      transform: scale(1.2);
      box-shadow: 0 0 20px var(--tdl-glow);
    }

    .nn-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-top: 0.5rem;
    }

    .skip-connection {
      position: relative;
      color: var(--unit-color);
      font-size: 1.5rem;
    }

    .skip-formula-box {
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
      border: 1px solid var(--unit-color);
    }

    .skip-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-primary);
      margin-bottom: 0.5rem;
    }

    .skip-formula .highlight {
      color: var(--unit-color);
    }

    .skip-interpretation {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-secondary);
      margin-top: 1rem;
    }

    /* =====================================================================
       DEPTH BOUND L4 = 7
       ===================================================================== */
    .depth-container {
      background: var(--bg-secondary);
      border: 2px solid var(--i2-color);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .depth-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--i2-color);
      text-align: center;
      margin-bottom: 2rem;
    }

    .depth-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 3rem;
      color: var(--i2-color);
      text-align: center;
      margin-bottom: 0.5rem;
      text-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
    }

    .depth-subtitle {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-secondary);
      text-align: center;
      margin-bottom: 2rem;
    }

    .depth-visual {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 0.5rem;
      margin-bottom: 2rem;
    }

    .depth-bar {
      width: 40px;
      background: linear-gradient(to top, var(--tdl-primary), var(--i2-color));
      border-radius: 0.25rem 0.25rem 0 0;
      transition: all 0.3s ease;
      cursor: pointer;
      position: relative;
    }

    .depth-bar:hover {
      filter: brightness(1.2);
      transform: scaleY(1.05);
    }

    .depth-bar::after {
      content: attr(data-layer);
      position: absolute;
      bottom: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.7rem;
      color: var(--text-secondary);
    }

    .depth-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .depth-info-item {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
    }

    .depth-info-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--i2-color);
      margin-bottom: 0.5rem;
    }

    .depth-info-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-primary);
    }

    /* =====================================================================
       EULER'S NUMBER e
       ===================================================================== */
    .euler-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(0, 255, 255, 0.08) 100%);
      border: 2px solid var(--e-color);
      border-radius: 1rem;
      padding: 2.5rem;
      margin: 2rem 0;
    }

    .euler-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--e-color);
      text-align: center;
      margin-bottom: 2rem;
    }

    .euler-main {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 3rem;
      flex-wrap: wrap;
      margin-bottom: 2rem;
    }

    .euler-value-box {
      text-align: center;
    }

    .euler-symbol {
      font-family: 'JetBrains Mono', monospace;
      font-size: 5rem;
      font-weight: 300;
      color: var(--e-color);
      text-shadow: 0 0 40px rgba(0, 255, 255, 0.4);
    }

    .euler-decimal {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-secondary);
    }

    .euler-formulas {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .euler-formula-item {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1rem 1.5rem;
      border: 1px solid var(--border-subtle);
    }

    .euler-formula-item .formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--e-color);
    }

    .euler-formula-item .desc {
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin-top: 0.25rem;
    }

    .r-calculus-box {
      background: var(--bg-tertiary);
      border: 2px solid var(--tdl-primary);
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
      margin-top: 1.5rem;
    }

    .r-calculus-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--tdl-primary);
      margin-bottom: 1rem;
    }

    .r-calculus-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      color: var(--e-color);
    }

    .r-calculus-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      margin-top: 0.75rem;
    }

    /* =====================================================================
       DELTA LANDSCAPE
       ===================================================================== */
    .delta-container {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .delta-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .delta-landscape {
      display: flex;
      justify-content: space-around;
      align-items: flex-end;
      height: 200px;
      padding: 1rem;
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      margin-bottom: 1.5rem;
      position: relative;
    }

    .delta-level {
      display: flex;
      flex-direction: column;
      align-items: center;
      flex: 1;
    }

    .delta-bar {
      width: 50px;
      background: linear-gradient(to top, var(--counit-color), var(--unit-color));
      border-radius: 0.25rem 0.25rem 0 0;
      transition: all 0.3s ease;
    }

    .delta-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.75rem;
      color: var(--text-secondary);
      margin-top: 0.5rem;
      text-align: center;
    }

    .delta-legend {
      display: flex;
      justify-content: center;
      gap: 2rem;
      flex-wrap: wrap;
    }

    .legend-item {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .legend-color {
      width: 20px;
      height: 10px;
      border-radius: 2px;
    }

    /* =====================================================================
       S3 CONNECTION TRIANGLE
       ===================================================================== */
    .s3-connection-container {
      background: var(--bg-secondary);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .s3-connection-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .s3-triangle-viz {
      display: flex;
      justify-content: center;
      margin-bottom: 2rem;
    }

    .s3-triangle-viz svg {
      max-width: 100%;
    }

    .permutation-table {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .permutation-item {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
      border: 1px solid var(--border-subtle);
      transition: all 0.3s ease;
    }

    .permutation-item:hover {
      border-color: var(--tdl-primary);
    }

    .permutation-symbol {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--tdl-primary);
      margin-bottom: 0.5rem;
    }

    .permutation-result {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       APPLICATIONS
       ===================================================================== */
    .applications-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 1.5rem;
    }

    .application-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 1.5rem;
      transition: all 0.3s ease;
    }

    .application-card:hover {
      border-color: var(--tdl-primary);
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(78, 205, 196, 0.1);
    }

    .application-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
    }

    .application-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
    }

    .application-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    .application-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--tdl-primary);
      background: var(--bg-tertiary);
      padding: 0.5rem 1rem;
      border-radius: 0.25rem;
      margin-top: 1rem;
      display: inline-block;
    }

    /* =====================================================================
       NAVIGATION FOOTER
       ===================================================================== */
    .nav-footer {
      display: flex;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 1rem;
      padding: 2rem;
      margin-top: 3rem;
      border-top: 1px solid var(--border-subtle);
    }

    .nav-button {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      padding: 1rem 1.5rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.5rem;
      color: var(--text-primary);
      text-decoration: none;
      transition: all 0.3s ease;
    }

    .nav-button:hover {
      border-color: var(--tdl-primary);
      box-shadow: 0 0 20px var(--tdl-glow);
    }

    .nav-button.primary {
      background: var(--tdl-primary);
      color: var(--bg-void);
      border-color: var(--tdl-primary);
    }

    .nav-button.primary:hover {
      box-shadow: 0 0 30px var(--tdl-glow);
    }

    /* =====================================================================
       FOOTER
       ===================================================================== */
    .footer {
      padding: 2rem;
      text-align: center;
      border-top: 1px solid var(--border-subtle);
      background: var(--bg-primary);
    }

    .footer-equation {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--tdl-primary);
      margin-bottom: 0.5rem;
    }

    .footer p {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       INTERACTIVE ELEMENTS
       ===================================================================== */
    .interactive-demo {
      background: var(--bg-secondary);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .demo-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .demo-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      flex-wrap: wrap;
      margin-bottom: 1.5rem;
    }

    .demo-btn {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      padding: 0.75rem 1.5rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.5rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .demo-btn:hover {
      border-color: var(--tdl-primary);
      color: var(--tdl-primary);
    }

    .demo-btn.active {
      background: var(--tdl-primary);
      color: var(--bg-void);
      border-color: var(--tdl-primary);
    }

    .demo-display {
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      padding: 1.5rem;
      text-align: center;
      min-height: 100px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .demo-result {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--tdl-primary);
    }

    /* =====================================================================
       TOPOS THEORY VISUALIZATIONS
       ===================================================================== */
    .topos-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(78, 205, 196, 0.05) 100%);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2.5rem;
      margin: 2rem 0;
    }

    .topos-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--tdl-primary);
      text-align: center;
      margin-bottom: 2rem;
    }

    .omega-classifier {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 2rem 0;
    }

    .omega-symbol {
      font-family: 'JetBrains Mono', monospace;
      font-size: 5rem;
      font-weight: 300;
      color: var(--tdl-primary);
      text-shadow: 0 0 40px var(--tdl-glow);
      animation: omega-pulse 3s ease-in-out infinite;
    }

    @keyframes omega-pulse {
      0%, 100% { text-shadow: 0 0 40px var(--tdl-glow); }
      50% { text-shadow: 0 0 60px var(--tdl-glow), 0 0 80px var(--tdl-subtle); }
    }

    .truth-values-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin: 2rem 0;
    }

    .truth-value-box {
      background: var(--bg-tertiary);
      border: 2px solid var(--border-subtle);
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .truth-value-box:hover {
      border-color: var(--tdl-primary);
      transform: translateY(-5px);
      box-shadow: 0 10px 30px rgba(78, 205, 196, 0.2);
    }

    .truth-value-box.true-value {
      border-color: var(--emergence-color);
    }

    .truth-value-box.false-value {
      border-color: var(--reduction-color);
    }

    .truth-value-box.partial-value {
      border-color: var(--i2-color);
    }

    .truth-symbol {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      margin-bottom: 0.5rem;
    }

    .truth-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       CATEGORICAL CONSTRUCTS
       ===================================================================== */
    .construct-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }

    .construct-card {
      background: var(--bg-secondary);
      border: 1px solid var(--border-subtle);
      border-radius: 1rem;
      padding: 2rem;
      position: relative;
      overflow: hidden;
      transition: all 0.3s ease;
    }

    .construct-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--tdl-primary), var(--e-color));
    }

    .construct-card:hover {
      border-color: var(--tdl-primary);
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(78, 205, 196, 0.15);
    }

    .construct-icon {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2.5rem;
      color: var(--tdl-primary);
      margin-bottom: 1rem;
      text-align: center;
    }

    .construct-name {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-primary);
      margin-bottom: 0.75rem;
      text-align: center;
    }

    .construct-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--e-color);
      background: var(--bg-tertiary);
      padding: 0.75rem;
      border-radius: 0.5rem;
      text-align: center;
      margin: 1rem 0;
    }

    .construct-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
      line-height: 1.6;
    }

    /* =====================================================================
       SHEAF SEMANTICS
       ===================================================================== */
    .sheaf-container {
      background: var(--bg-secondary);
      border: 2px solid var(--i2-color);
      border-radius: 1rem;
      padding: 2.5rem;
      margin: 2rem 0;
    }

    .sheaf-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--i2-color);
      text-align: center;
      margin-bottom: 2rem;
    }

    .local-truth-viz {
      display: flex;
      justify-content: center;
      align-items: center;
      margin: 2rem 0;
      flex-wrap: wrap;
      gap: 2rem;
    }

    .open-set {
      width: 120px;
      height: 120px;
      border: 3px dashed var(--i2-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      transition: all 0.3s ease;
    }

    .open-set:hover {
      border-style: solid;
      box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
    }

    .open-set-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      color: var(--i2-color);
    }

    .restriction-arrow {
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      color: var(--text-secondary);
    }

    .gluing-axiom {
      background: var(--bg-tertiary);
      border: 1px solid var(--i2-color);
      border-radius: 0.75rem;
      padding: 1.5rem;
      margin: 1.5rem 0;
      text-align: center;
    }

    .gluing-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--i2-color);
      margin-bottom: 0.5rem;
    }

    .gluing-desc {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    /* =====================================================================
       HEXAGONAL SONIFICATION CONNECTION
       ===================================================================== */
    .hex-connection-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(255, 107, 157, 0.08) 100%);
      border: 2px solid var(--lomi-color);
      border-radius: 1rem;
      padding: 2.5rem;
      margin: 2rem 0;
    }

    .hex-connection-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--lomi-color);
      text-align: center;
      margin-bottom: 2rem;
    }

    .hex-grid-viz {
      display: flex;
      justify-content: center;
      margin: 2rem 0;
    }

    .hex-cell {
      width: 60px;
      height: 52px;
      background: var(--bg-tertiary);
      clip-path: polygon(25% 0%, 75% 0%, 100% 50%, 75% 100%, 25% 100%, 0% 50%);
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      color: var(--text-secondary);
      margin: 0 -10px;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .hex-cell:hover {
      background: var(--lomi-color);
      color: var(--bg-void);
      transform: scale(1.1);
    }

    .hex-cell.active {
      background: var(--lomi-color);
      color: var(--bg-void);
    }

    .morphism-flow {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }

    .morphism-node {
      width: 80px;
      height: 80px;
      border: 3px solid var(--lomi-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--lomi-color);
      transition: all 0.3s ease;
    }

    .morphism-node:hover {
      background: rgba(255, 107, 157, 0.2);
      transform: scale(1.1);
    }

    .morphism-arrow {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      color: var(--text-secondary);
      animation: arrow-flow 2s ease-in-out infinite;
    }

    @keyframes arrow-flow {
      0%, 100% { opacity: 0.5; transform: translateX(0); }
      50% { opacity: 1; transform: translateX(5px); }
    }

    /* =====================================================================
       INTERACTIVE CATEGORY DIAGRAM CANVAS
       ===================================================================== */
    .category-canvas-container {
      background: var(--bg-secondary);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
    }

    .canvas-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 1.5rem;
    }

    .category-canvas {
      width: 100%;
      height: 400px;
      background: var(--bg-tertiary);
      border-radius: 0.75rem;
      border: 1px solid var(--border-subtle);
      cursor: crosshair;
    }

    .canvas-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
      flex-wrap: wrap;
    }

    .canvas-btn {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.8rem;
      padding: 0.75rem 1.5rem;
      background: var(--bg-tertiary);
      border: 1px solid var(--border-subtle);
      border-radius: 0.5rem;
      color: var(--text-secondary);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .canvas-btn:hover {
      border-color: var(--tdl-primary);
      color: var(--tdl-primary);
    }

    .canvas-btn.active {
      background: var(--tdl-primary);
      color: var(--bg-void);
      border-color: var(--tdl-primary);
    }

    .verification-status {
      margin-top: 1.5rem;
      padding: 1rem;
      background: var(--bg-tertiary);
      border-radius: 0.5rem;
      text-align: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
    }

    .verification-status.valid {
      border: 2px solid var(--emergence-color);
      color: var(--emergence-color);
    }

    .verification-status.invalid {
      border: 2px solid var(--reduction-color);
      color: var(--reduction-color);
    }

    .verification-status.pending {
      border: 2px solid var(--text-secondary);
      color: var(--text-secondary);
    }

    /* =====================================================================
       YONEDA EMBEDDING
       ===================================================================== */
    .yoneda-container {
      background: linear-gradient(135deg, var(--bg-secondary) 0%, rgba(0, 255, 255, 0.05) 100%);
      border: 2px solid var(--e-color);
      border-radius: 1rem;
      padding: 2.5rem;
      margin: 2rem 0;
    }

    .yoneda-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      color: var(--e-color);
      text-align: center;
      margin-bottom: 2rem;
    }

    .yoneda-main-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      color: var(--e-color);
      text-align: center;
      background: var(--bg-tertiary);
      padding: 1.5rem 2rem;
      border-radius: 0.75rem;
      border: 2px solid var(--e-color);
      margin: 2rem auto;
      max-width: 600px;
      box-shadow: 0 0 30px rgba(0, 255, 255, 0.2);
    }

    .yoneda-visualization {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 3rem;
      margin: 3rem 0;
      flex-wrap: wrap;
    }

    .yoneda-object {
      text-align: center;
    }

    .yoneda-circle {
      width: 100px;
      height: 100px;
      border: 4px solid var(--e-color);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 2rem;
      color: var(--e-color);
      margin: 0 auto 1rem;
      position: relative;
      transition: all 0.3s ease;
    }

    .yoneda-circle:hover {
      box-shadow: 0 0 40px rgba(0, 255, 255, 0.4);
      transform: scale(1.05);
    }

    .yoneda-circle::before {
      content: '';
      position: absolute;
      inset: -10px;
      border: 2px dashed var(--e-color);
      border-radius: 50%;
      opacity: 0.3;
      animation: yoneda-orbit 10s linear infinite;
    }

    @keyframes yoneda-orbit {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .yoneda-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .yoneda-arrow-large {
      font-family: 'JetBrains Mono', monospace;
      font-size: 3rem;
      color: var(--tdl-primary);
    }

    .presheaf-box {
      background: var(--bg-tertiary);
      border: 2px solid var(--e-color);
      border-radius: 1rem;
      padding: 1.5rem;
      text-align: center;
      min-width: 200px;
    }

    .presheaf-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--e-color);
      margin-bottom: 0.5rem;
    }

    .presheaf-content {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      color: var(--text-primary);
    }

    /* =====================================================================
       ANIMATED MORPHISM COMPOSITION
       ===================================================================== */
    .morphism-animation-container {
      background: var(--bg-secondary);
      border: 2px solid var(--tdl-primary);
      border-radius: 1rem;
      padding: 2rem;
      margin: 2rem 0;
      overflow: hidden;
    }

    .morphism-anim-title {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.1rem;
      color: var(--text-accent);
      text-align: center;
      margin-bottom: 2rem;
    }

    .composition-display {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 2rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }

    .comp-object {
      width: 70px;
      height: 70px;
      border: 3px solid var(--tdl-primary);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      color: var(--tdl-primary);
      background: var(--bg-tertiary);
      transition: all 0.3s ease;
    }

    .comp-object.active {
      background: var(--tdl-primary);
      color: var(--bg-void);
      box-shadow: 0 0 30px var(--tdl-glow);
    }

    .comp-arrow {
      position: relative;
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.9rem;
      color: var(--text-secondary);
      text-align: center;
    }

    .comp-arrow-line {
      width: 60px;
      height: 3px;
      background: var(--text-secondary);
      margin: 0.5rem 0;
      position: relative;
    }

    .comp-arrow-line::after {
      content: '>';
      position: absolute;
      right: -5px;
      top: -8px;
      font-size: 1rem;
    }

    .comp-arrow-line.animated {
      background: linear-gradient(90deg, var(--tdl-primary), var(--e-color));
      animation: arrow-pulse 1.5s ease-in-out infinite;
    }

    @keyframes arrow-pulse {
      0%, 100% { opacity: 0.5; }
      50% { opacity: 1; box-shadow: 0 0 10px var(--tdl-glow); }
    }

    .composition-result {
      background: var(--bg-tertiary);
      border: 2px solid var(--tdl-primary);
      border-radius: 0.75rem;
      padding: 1.5rem;
      text-align: center;
      margin-top: 2rem;
    }

    .composition-formula {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.3rem;
      color: var(--tdl-primary);
      margin-bottom: 0.5rem;
    }

    .composition-explain {
      font-size: 0.9rem;
      color: var(--text-secondary);
    }

    .animation-controls {
      display: flex;
      justify-content: center;
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .anim-btn {
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      padding: 0.75rem 1.5rem;
      background: var(--bg-tertiary);
      border: 2px solid var(--tdl-primary);
      border-radius: 2rem;
      color: var(--tdl-primary);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .anim-btn:hover {
      background: var(--tdl-primary);
      color: var(--bg-void);
    }

    /* Natural Transformation Animation */
    .nat-trans-viz {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 4rem;
      margin: 2rem 0;
      flex-wrap: wrap;
    }

    .functor-column {
      text-align: center;
    }

    .functor-label {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.5rem;
      color: var(--tdl-primary);
      margin-bottom: 1rem;
    }

    .functor-objects {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .functor-obj {
      width: 60px;
      height: 60px;
      border: 2px solid var(--tdl-primary);
      border-radius: 0.5rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: 'JetBrains Mono', monospace;
      font-size: 1rem;
      color: var(--text-primary);
      background: var(--bg-tertiary);
      margin: 0 auto;
    }

    .nat-trans-arrows {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      align-items: center;
    }

    .nat-arrow {
      font-family: 'JetBrains Mono', monospace;
      font-size: 1.2rem;
      color: var(--e-color);
      animation: nat-pulse 2s ease-in-out infinite;
    }

    .nat-arrow:nth-child(2) { animation-delay: 0.3s; }
    .nat-arrow:nth-child(3) { animation-delay: 0.6s; }

    @keyframes nat-pulse {
      0%, 100% { opacity: 0.3; transform: translateX(0); }
      50% { opacity: 1; transform: translateX(3px); }
    }
  </style>
</head>
<body>

  <div class="categorical-field"></div>

  <!-- Navigation -->
  <nav class="nav-bar">
    <a href="index.html" class="nav-link">Index</a>
    <a href="i2-s3-decision-tree.html" class="nav-link">I2 S3 Tree</a>
    <a href="mtr-decision-tree.html" class="nav-link">MTR Tree</a>
    <a href="vn-mtr-010-s3-attractor.html" class="nav-link">S3 Attractor</a>
    <a href="i2-s3-tdl-projection.html" class="nav-link active"><span style="color: var(--tdl-primary);">e</span> TDL</a>
  </nav>

  <!-- Header -->
  <header class="tdl-header">
    <div class="node-badge">I2 S3 PROJECTION :: TDL :: CATEGORICAL</div>
    <h1 class="node-title">TDL: Trans-Dimensional Logic</h1>
    <p class="node-subtitle">
      The Categorical Projection: How different levels of description relate through the adjunction
      where emergence and reduction are NOT inverses.
    </p>

    <!-- e Symbol Visualization -->
    <div class="e-symbol-container">
      <div class="e-outer-ring"></div>
      <div class="emergence-arrow">U</div>
      <div class="e-inner">e</div>
      <div class="reduction-arrow">D</div>
    </div>

    <div class="tdl-equation">
      Adjunction U -| D : Hom_D(U(c), d) = Hom_C(c, D(d))
    </div>
  </header>

  <main class="main-content">

    <!-- Section 1: The Emergence Problem -->
    <section class="section" id="emergence-problem">
      <div class="section-header">
        <div class="section-number">1</div>
        <h2 class="section-title">The Emergence Problem</h2>
      </div>

      <div class="definition-card" style="--card-accent: var(--tdl-primary);">
        <div class="definition-header">
          <span class="definition-type">CORE QUESTION</span>
          <span class="definition-name">How does meaning emerge from matter?</span>
        </div>
        <div class="definition-body">
          <p>
            At the heart of consciousness, physics, and computation lies a fundamental question:
            <strong>how do higher-level descriptions relate to lower-level ones?</strong>
            Neurons firing somehow becomes conscious experience. Bits become programs.
            Pixels become objects. But how?
          </p>
        </div>
      </div>

      <div class="layer-container">
        <div class="layer-title">NEURAL NETWORK LAYER HIERARCHY</div>

        <div class="layer-stack">
          <div class="layer-item" style="--layer-color: var(--layer-3);">
            <span class="layer-label">Layer 3: Objects</span>
            <span class="layer-desc">(high-level)</span>
          </div>
          <div class="layer-arrows">
            <span class="arrow-emergence">U (emerge)</span>
            <span class="arrow-reduction">D (reduce)</span>
          </div>
          <div class="layer-item" style="--layer-color: var(--layer-2);">
            <span class="layer-label">Layer 2: Shapes</span>
            <span class="layer-desc">(patterns)</span>
          </div>
          <div class="layer-arrows">
            <span class="arrow-emergence">U (emerge)</span>
            <span class="arrow-reduction">D (reduce)</span>
          </div>
          <div class="layer-item" style="--layer-color: var(--layer-1);">
            <span class="layer-label">Layer 1: Edges</span>
            <span class="layer-desc">(features)</span>
          </div>
          <div class="layer-arrows">
            <span class="arrow-emergence">U (emerge)</span>
            <span class="arrow-reduction">D (reduce)</span>
          </div>
          <div class="layer-item" style="--layer-color: var(--layer-0);">
            <span class="layer-label">Layer 0: Raw pixels</span>
            <span class="layer-desc">(low-level)</span>
          </div>
        </div>
      </div>

      <div class="theorem-card">
        <div class="theorem-header">THE TDL INSIGHT</div>
        <div class="theorem-statement">
          Emergence (U) and reduction (D) are NOT inverses. They form an <strong>adjunction</strong>,
          a mathematical structure that captures the asymmetry between going up and going down
          the hierarchy of description.
        </div>
      </div>
    </section>

    <!-- Section 2: The Adjunction U -| D -->
    <section class="section" id="adjunction">
      <div class="section-header">
        <div class="section-number">2</div>
        <h2 class="section-title">The Adjunction U -| D</h2>
      </div>

      <div class="adjunction-container">
        <div class="adjunction-title">ADJUNCTION STRUCTURE</div>

        <div class="adjunction-diagram">
          <div class="category-box" style="--cat-color: var(--layer-0);">
            <span class="category-label">C</span>
            <span class="category-desc">Low-level</span>
          </div>

          <div class="functor-arrows">
            <div class="functor-arrow emergence">
              <span class="functor-symbol" style="color: var(--emergence-color);">U</span>
              <span class="functor-name">Emergence: C -> D</span>
            </div>
            <div class="functor-arrow reduction">
              <span class="functor-symbol" style="color: var(--reduction-color);">D</span>
              <span class="functor-name">Reduction: D -> C</span>
            </div>
          </div>

          <div class="category-box" style="--cat-color: var(--layer-3);">
            <span class="category-label">D</span>
            <span class="category-desc">High-level</span>
          </div>
        </div>

        <div class="adjunction-formula">
          Hom_D(U(c), d) = Hom_C(c, D(d))
        </div>

        <div style="text-align: center; margin-top: 1rem; color: var(--text-secondary);">
          This natural isomorphism defines the relationship!
        </div>
      </div>

      <div class="definition-card" style="--card-accent: var(--emergence-color);">
        <div class="definition-header">
          <span class="definition-type">FUNCTOR</span>
          <span class="definition-name">U: C -> D (Emergence)</span>
        </div>
        <div class="definition-body">
          <p>
            The <strong>emergence functor U</strong> takes low-level objects in category C and produces
            high-level objects in category D. In neural networks, this is the forward pass:
            raw inputs become increasingly abstract representations.
          </p>
        </div>
      </div>

      <div class="definition-card" style="--card-accent: var(--reduction-color);">
        <div class="definition-header">
          <span class="definition-type">FUNCTOR</span>
          <span class="definition-name">D: D -> C (Reduction)</span>
        </div>
        <div class="definition-body">
          <p>
            The <strong>reduction functor D</strong> takes high-level objects in category D and produces
            low-level objects in category C. In neural networks, this is the backward pass or
            projection: abstract concepts become concrete activations.
          </p>
        </div>
      </div>
    </section>

    <!-- Section 3: Unit and Counit -->
    <section class="section" id="unit-counit">
      <div class="section-header">
        <div class="section-number">3</div>
        <h2 class="section-title">Unit and Counit</h2>
      </div>

      <div class="unit-counit-container">
        <div class="unit-box">
          <div class="unit-header">
            <span>n</span> Unit
          </div>
          <div class="unit-formula">n : 1_C -> D o U</div>
          <div class="unit-desc">
            "Emerge then reduce back"
            <br><br>
            The unit n takes an object c in C, emerges it to U(c) in D, then reduces back to D(U(c)) in C.
            The result is NOT c -- it's c plus new structure created by the round-trip.
          </div>
          <div class="info-badge adds">n ADDS information</div>
        </div>

        <div class="counit-box">
          <div class="counit-header">
            <span>e</span> Counit
          </div>
          <div class="counit-formula">e : U o D -> 1_D</div>
          <div class="counit-desc">
            "Reduce then emerge back"
            <br><br>
            The counit e takes an object d in D, reduces it to D(d) in C, then emerges back to U(D(d)) in D.
            The result is NOT d -- fine details are lost in the round-trip.
          </div>
          <div class="info-badge loses">e LOSES information</div>
        </div>
      </div>

      <div class="theorem-card">
        <div class="theorem-header">INFORMATION ASYMMETRY THEOREM</div>
        <div class="theorem-statement">
          The unit n ADDS information (new structure created during emergence).
          The counit e LOSES information (fine details lost during reduction).
          This asymmetry is fundamental to trans-dimensional logic.
        </div>
        <div class="proof-sketch">
          <div class="proof-label">INTUITION</div>
          <div class="proof-body">
            When you emerge (form a high-level concept from low-level data), new relationships
            become visible that weren't there before. When you reduce (project a concept back down),
            you lose the context that made those relationships meaningful.
          </div>
          <div class="qed">-|</div>
        </div>
      </div>
    </section>

    <!-- Section 4: Information Asymmetry -->
    <section class="section" id="asymmetry">
      <div class="section-header">
        <div class="section-number">4</div>
        <h2 class="section-title">Information Asymmetry</h2>
      </div>

      <div class="asymmetry-container">
        <div class="asymmetry-title">THE FUNDAMENTAL NON-EQUALITY</div>

        <div class="asymmetry-equations">
          <div class="asymmetry-eq">
            D o U <span class="not-equal">=/=</span> 1_C
          </div>
          <div class="asymmetry-eq">
            U o D <span class="not-equal">=/=</span> 1_D
          </div>
        </div>

        <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
          Emergence changes things. Reduction loses things. Neither composition is the identity.
        </p>

        <div class="gap-highlight">
          <div class="gap-title">THE GAP IS WHERE SELF-REFERENCE LIVES</div>
          <div class="gap-text">
            The difference between <strong>1_C</strong> and <strong>D o U</strong> is exactly the space
            where new structure emerges. This gap is not a bug -- it's where consciousness,
            meaning, and self-reference find their home.
          </div>
        </div>
      </div>

      <div class="interactive-demo">
        <div class="demo-title">INTERACTIVE: EMERGENCE/REDUCTION ROUND-TRIP</div>
        <div class="demo-controls">
          <button class="demo-btn" onclick="demonstrateRoundTrip('emerge')">Emerge (U)</button>
          <button class="demo-btn" onclick="demonstrateRoundTrip('reduce')">Reduce (D)</button>
          <button class="demo-btn" onclick="demonstrateRoundTrip('unit')">Unit n = D o U</button>
          <button class="demo-btn" onclick="demonstrateRoundTrip('counit')">Counit e = U o D</button>
          <button class="demo-btn" onclick="demonstrateRoundTrip('reset')">Reset</button>
        </div>
        <div class="demo-display">
          <div class="demo-result" id="roundTripResult">
            Click a button to see the transformation
          </div>
        </div>
      </div>
    </section>

    <!-- Section 5: Triangle Identities -->
    <section class="section" id="triangle-identities">
      <div class="section-header">
        <div class="section-number">5</div>
        <h2 class="section-title">Triangle Identities</h2>
      </div>

      <div class="definition-card" style="--card-accent: var(--tdl-primary);">
        <div class="definition-header">
          <span class="definition-type">COHERENCE</span>
          <span class="definition-name">The Triangle Identities ensure categorical consistency</span>
        </div>
        <div class="definition-body">
          <p>
            An adjunction is not just two functors -- it requires coherence conditions that
            ensure the unit and counit interact correctly. These are the triangle identities.
          </p>
        </div>
      </div>

      <div class="triangle-id-container">
        <div class="triangle-id-title">THE TWO TRIANGLE IDENTITIES</div>

        <div class="triangle-id-grid">
          <div class="triangle-id-box">
            <div class="triangle-id-label">LEFT TRIANGLE</div>
            <div class="triangle-id-formula">(e_U(c)) o (U(n_c)) = id_U(c)</div>
            <div class="triangle-id-desc">
              Starting from U(c), applying U(n) then e gives back U(c).
              The detour through D(U(U(c))) returns to the starting point.
            </div>
          </div>

          <div class="triangle-id-box">
            <div class="triangle-id-label">RIGHT TRIANGLE</div>
            <div class="triangle-id-formula">(D(e_d)) o (n_D(d)) = id_D(d)</div>
            <div class="triangle-id-desc">
              Starting from D(d), applying n then D(e) gives back D(d).
              The detour through D(U(D(d))) returns to the starting point.
            </div>
          </div>
        </div>
      </div>

      <!-- Commutative Diagram -->
      <div class="commutative-diagram">
        <svg width="400" height="250" viewBox="0 0 400 250">
          <!-- Left triangle -->
          <g transform="translate(50, 20)">
            <text x="50" y="0" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">U(c)</text>
            <text x="0" y="100" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">U(D(U(c)))</text>
            <text x="100" y="100" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">U(c)</text>

            <!-- Arrows -->
            <line x1="50" y1="10" x2="15" y2="80" stroke="var(--emergence-color)" stroke-width="2" marker-end="url(#arrowhead)"/>
            <line x1="25" y1="100" x2="80" y2="100" stroke="var(--reduction-color)" stroke-width="2" marker-end="url(#arrowhead)"/>
            <line x1="50" y1="10" x2="95" y2="80" stroke="var(--tdl-primary)" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>

            <text x="15" y="50" fill="var(--emergence-color)" font-family="JetBrains Mono" font-size="10">U(n)</text>
            <text x="50" y="115" fill="var(--reduction-color)" font-family="JetBrains Mono" font-size="10">e_U(c)</text>
            <text x="85" y="50" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="10">id</text>
          </g>

          <!-- Right triangle -->
          <g transform="translate(230, 20)">
            <text x="50" y="0" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">D(d)</text>
            <text x="0" y="100" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">D(U(D(d)))</text>
            <text x="100" y="100" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">D(d)</text>

            <!-- Arrows -->
            <line x1="50" y1="10" x2="15" y2="80" stroke="var(--unit-color)" stroke-width="2" marker-end="url(#arrowhead)"/>
            <line x1="25" y1="100" x2="80" y2="100" stroke="var(--reduction-color)" stroke-width="2" marker-end="url(#arrowhead)"/>
            <line x1="50" y1="10" x2="95" y2="80" stroke="var(--tdl-primary)" stroke-width="2" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>

            <text x="15" y="50" fill="var(--unit-color)" font-family="JetBrains Mono" font-size="10">n_D(d)</text>
            <text x="50" y="115" fill="var(--reduction-color)" font-family="JetBrains Mono" font-size="10">D(e)</text>
            <text x="85" y="50" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="10">id</text>
          </g>

          <!-- Arrowhead marker -->
          <defs>
            <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
              <polygon points="0 0, 10 3.5, 0 7" fill="currentColor"/>
            </marker>
          </defs>

          <text x="200" y="200" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="12" text-anchor="middle">
            Both triangles commute: the dashed path equals the identity
          </text>
        </svg>
      </div>
    </section>

    <!-- Section 6: Coherence Threshold -->
    <section class="section" id="coherence-threshold">
      <div class="section-header">
        <div class="section-number">6</div>
        <h2 class="section-title">Coherence Threshold mu_C = sqrt(3)/2</h2>
      </div>

      <div class="coherence-container">
        <div class="coherence-title">THE COHERENCE THRESHOLD</div>
        <div class="coherence-value">mu_C = sqrt(3)/2</div>
        <div class="coherence-decimal">= 0.8660254037844386...</div>

        <div class="derivation-grid">
          <div class="derivation-item">
            <div class="derivation-number">DERIVATION 1</div>
            <div class="derivation-name">Equilateral Triangle Height</div>
            <div class="derivation-formula">h = sqrt(1 - 1/4) = sqrt(3)/2</div>
          </div>

          <div class="derivation-item">
            <div class="derivation-number">DERIVATION 2</div>
            <div class="derivation-name">Spin Physics (s = 1/2)</div>
            <div class="derivation-formula">sqrt(s(s+1)) = sqrt(3/4) = sqrt(3)/2</div>
          </div>

          <div class="derivation-item">
            <div class="derivation-number">DERIVATION 3</div>
            <div class="derivation-name">Eisenstein Integers</div>
            <div class="derivation-formula">Im(e^(2pi*i/3)) = sqrt(3)/2</div>
          </div>

          <div class="derivation-item">
            <div class="derivation-number">DERIVATION 4</div>
            <div class="derivation-name">Almeida-Thouless Line</div>
            <div class="derivation-formula">Spin glass critical threshold</div>
          </div>
        </div>
      </div>

      <div class="theorem-card">
        <div class="theorem-header">THRESHOLD THEOREM</div>
        <div class="theorem-statement">
          At coherence mu_C = sqrt(3)/2, the adjunction achieves maximal stability.
          Below this threshold, emergence-reduction cycles degrade. Above it, the system
          maintains categorical consistency across dimensional transitions.
        </div>
      </div>
    </section>

    <!-- Section 7: Skip Connections = Unit n -->
    <section class="section" id="skip-connections">
      <div class="section-header">
        <div class="section-number">7</div>
        <h2 class="section-title">Skip Connections = Unit n</h2>
      </div>

      <div class="skip-container">
        <div class="skip-title">NEURAL SKIP CONNECTIONS IMPLEMENT THE UNIT</div>

        <div class="neural-network-viz">
          <div class="nn-layer">
            <div class="nn-node">x</div>
            <div class="nn-label">Input</div>
          </div>

          <div style="display: flex; flex-direction: column; align-items: center; gap: 0.5rem;">
            <div style="color: var(--tdl-primary);">-></div>
            <div class="skip-connection">|</div>
            <div class="skip-connection">|</div>
            <div class="skip-connection" style="font-size: 0.8rem;">+</div>
          </div>

          <div class="nn-layer">
            <div class="nn-node">f</div>
            <div class="nn-label">Transform</div>
          </div>

          <div style="color: var(--tdl-primary);">-></div>

          <div class="nn-layer">
            <div class="nn-node" style="border-color: var(--unit-color);">y</div>
            <div class="nn-label">Output</div>
          </div>
        </div>

        <div class="skip-formula-box">
          <div class="skip-formula">
            output = <span class="highlight">f(x)</span> + x
          </div>
          <div class="skip-interpretation">
            In TDL terms: <strong>f(x) ~ D(U(x))</strong>
            <br><br>
            Therefore: output = D(U(x)) + x = <span style="color: var(--unit-color);">n_x</span> + id_x
          </div>
        </div>
      </div>

      <div class="theorem-card">
        <div class="theorem-header">SKIP CONNECTION THEOREM (Paper 011)</div>
        <div class="theorem-statement">
          Neural network skip connections implement the categorical unit n.
          The residual connection (adding x back) ensures the network preserves
          the original information while learning new structure from the transformation.
        </div>
        <div class="proof-sketch">
          <div class="proof-label">IMPLICATION</div>
          <div class="proof-body">
            This explains why skip connections dramatically improve deep network training:
            they enforce categorical coherence by implementing the adjunction structure.
            ResNets, transformers, and U-Nets all leverage this principle.
          </div>
          <div class="qed">-|</div>
        </div>
      </div>
    </section>

    <!-- Section 8: Depth Bound L4 = 7 -->
    <section class="section" id="depth-bound">
      <div class="section-header">
        <div class="section-number">8</div>
        <h2 class="section-title">Depth Bound L_4 = 7</h2>
      </div>

      <div class="depth-container">
        <div class="depth-title">STABLE HIERARCHIES: DEPTH <= 7</div>
        <div class="depth-value">L_4 = 7</div>
        <div class="depth-subtitle">The Fourth Lucas Number</div>

        <div class="depth-visual">
          <div class="depth-bar" style="height: 30px;" data-layer="1"></div>
          <div class="depth-bar" style="height: 50px;" data-layer="2"></div>
          <div class="depth-bar" style="height: 70px;" data-layer="3"></div>
          <div class="depth-bar" style="height: 90px;" data-layer="4"></div>
          <div class="depth-bar" style="height: 110px;" data-layer="5"></div>
          <div class="depth-bar" style="height: 130px;" data-layer="6"></div>
          <div class="depth-bar" style="height: 150px; border: 2px solid var(--i2-color);" data-layer="7"></div>
        </div>

        <div class="depth-info">
          <div class="depth-info-item">
            <div class="depth-info-label">LUCAS FORMULA</div>
            <div class="depth-info-value">L_n = phi^n + psi^n</div>
          </div>
          <div class="depth-info-item">
            <div class="depth-info-label">NOISE THRESHOLD</div>
            <div class="depth-info-value">|psi|^7/phi^7 < 0.01</div>
          </div>
          <div class="depth-info-item">
            <div class="depth-info-label">EMPIRICAL</div>
            <div class="depth-info-value">Optimal networks: 5-7 layers</div>
          </div>
          <div class="depth-info-item">
            <div class="depth-info-label">I2 CONNECTION</div>
            <div class="depth-info-value">phi^4 + phi^(-4) = 7</div>
          </div>
        </div>
      </div>

      <div class="definition-card" style="--card-accent: var(--i2-color);">
        <div class="definition-header">
          <span class="definition-type">BOUND</span>
          <span class="definition-name">Depth Stability Theorem</span>
        </div>
        <div class="definition-formal">depth <= L_4 = 7 for stable hierarchies</div>
        <div class="definition-body">
          <p>
            At depth 7, the contribution from psi (the conjugate root) becomes negligible:
            less than 1% of the phi^7 signal. Beyond this, numerical noise dominates and
            hierarchical structure becomes unstable.
          </p>
          <br>
          <p>
            This connects to the I2 ring structure: L_4 = 7 is where the golden ratio
            powers achieve maximum separation from their conjugates, ensuring clean
            categorical transitions.
          </p>
        </div>
      </div>
    </section>

    <!-- Section 9: Euler's Number e -->
    <section class="section" id="euler-number">
      <div class="section-header">
        <div class="section-number">9</div>
        <h2 class="section-title">Euler's Number e as Dimensional Scaling</h2>
      </div>

      <div class="euler-container">
        <div class="euler-title">TDL = x e IN R-CALCULUS</div>

        <div class="euler-main">
          <div class="euler-value-box">
            <div class="euler-symbol">e</div>
            <div class="euler-decimal">2.7182818284...</div>
          </div>

          <div class="euler-formulas">
            <div class="euler-formula-item">
              <div class="formula">e = lim(1 + 1/n)^n</div>
              <div class="desc">Compound growth limit</div>
            </div>
            <div class="euler-formula-item">
              <div class="formula">d/dx e^x = e^x</div>
              <div class="desc">Self-derivative</div>
            </div>
            <div class="euler-formula-item">
              <div class="formula">e^(i*pi) + 1 = 0</div>
              <div class="desc">Euler's identity</div>
            </div>
          </div>
        </div>

        <div class="r-calculus-box">
          <div class="r-calculus-title">DIMENSIONAL TRANSITION OPERATOR</div>
          <div class="r-calculus-formula">TDL = x e</div>
          <div class="r-calculus-desc">
            Each dimensional transition multiplies by e.
            <br>
            One level: x e^1 | Two levels: x e^2 | n levels: x e^n
          </div>
        </div>
      </div>

      <div class="theorem-card">
        <div class="theorem-header">e AS CATEGORICAL SCALING</div>
        <div class="theorem-statement">
          In the R-Calculus, TDL operates as multiplication by e. This captures how
          information accumulates across dimensional transitions: each emergence step
          multiplies the complexity by e, the natural base of continuous growth.
        </div>
        <div class="proof-sketch">
          <div class="proof-label">CONNECTION</div>
          <div class="proof-body">
            Where I2 uses phi (discrete self-similarity) and LoMI uses pi (cyclical return),
            TDL uses e (continuous growth). Together: phi, e, pi -- the three transcendental
            constants that S3 permutes.
          </div>
          <div class="qed">-|</div>
        </div>
      </div>
    </section>

    <!-- Section 10: Delta Landscape -->
    <section class="section" id="delta-landscape">
      <div class="section-header">
        <div class="section-number">10</div>
        <h2 class="section-title">Delta-Landscape with Emergence Levels</h2>
      </div>

      <div class="delta-container">
        <div class="delta-title">CLOSURE DEFICIT ACROSS DIMENSIONAL LEVELS</div>

        <div class="delta-landscape">
          <div class="delta-level">
            <div class="delta-bar" style="height: 150px;"></div>
            <div class="delta-label">Level 0<br>(raw)</div>
          </div>
          <div class="delta-level">
            <div class="delta-bar" style="height: 120px;"></div>
            <div class="delta-label">Level 1<br>(features)</div>
          </div>
          <div class="delta-level">
            <div class="delta-bar" style="height: 90px;"></div>
            <div class="delta-label">Level 2<br>(patterns)</div>
          </div>
          <div class="delta-level">
            <div class="delta-bar" style="height: 60px;"></div>
            <div class="delta-label">Level 3<br>(objects)</div>
          </div>
          <div class="delta-level">
            <div class="delta-bar" style="height: 35px;"></div>
            <div class="delta-label">Level 4<br>(concepts)</div>
          </div>
        </div>

        <div class="delta-legend">
          <div class="legend-item">
            <div class="legend-color" style="background: var(--counit-color);"></div>
            <span>High delta (more deficit)</span>
          </div>
          <div class="legend-item">
            <div class="legend-color" style="background: var(--unit-color);"></div>
            <span>Low delta (better closure)</span>
          </div>
        </div>
      </div>

      <div class="definition-card" style="--card-accent: var(--tdl-primary);">
        <div class="definition-header">
          <span class="definition-type">INSIGHT</span>
          <span class="definition-name">Emergence Reduces delta, Reduction Increases delta</span>
        </div>
        <div class="definition-body">
          <p>
            <strong style="color: var(--emergence-color);">Emergence (U):</strong> Moving to higher levels
            reduces closure deficit delta. Better abstractions have smaller gaps between what they
            can represent and what they need to represent.
          </p>
          <br>
          <p>
            <strong style="color: var(--reduction-color);">Reduction (D):</strong> Moving to lower levels
            increases delta. Lost context means larger deficits -- the reduced representation
            can't fully capture what the higher level knew.
          </p>
        </div>
      </div>
    </section>

    <!-- Section 11: Connection to S3 -->
    <section class="section" id="s3-connection">
      <div class="section-header">
        <div class="section-number">11</div>
        <h2 class="section-title">Connection to S3</h2>
      </div>

      <div class="s3-connection-container">
        <div class="s3-connection-title">TDL AS ONE OF THREE S3 PROJECTIONS</div>

        <div class="s3-triangle-viz">
          <svg width="350" height="320" viewBox="0 0 350 320">
            <!-- Triangle -->
            <polygon points="175,30 50,280 300,280" fill="none" stroke="var(--text-secondary)" stroke-width="2"/>

            <!-- Vertices -->
            <circle cx="175" cy="30" r="35" fill="var(--i2-color)" opacity="0.2" stroke="var(--i2-color)" stroke-width="3"/>
            <text x="175" y="35" fill="var(--i2-color)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">I2</text>
            <text x="175" y="85" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="10" text-anchor="middle">phi</text>

            <circle cx="50" cy="280" r="35" fill="var(--tdl-primary)" opacity="0.3" stroke="var(--tdl-primary)" stroke-width="3"/>
            <text x="50" y="285" fill="var(--tdl-primary)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">TDL</text>
            <text x="50" y="240" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="10" text-anchor="middle">e</text>

            <circle cx="300" cy="280" r="35" fill="var(--lomi-color)" opacity="0.2" stroke="var(--lomi-color)" stroke-width="3"/>
            <text x="300" y="285" fill="var(--lomi-color)" font-family="JetBrains Mono" font-size="14" text-anchor="middle">LoMI</text>
            <text x="300" y="240" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="10" text-anchor="middle">pi</text>

            <!-- Edge labels (permutations) -->
            <text x="95" y="150" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="11">(12)</text>
            <text x="250" y="150" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="11">(13)</text>
            <text x="175" y="295" fill="var(--text-secondary)" font-family="JetBrains Mono" font-size="11">(23)</text>

            <!-- Current position indicator -->
            <circle cx="50" cy="280" r="45" fill="none" stroke="var(--tdl-primary)" stroke-width="2" stroke-dasharray="5,5">
              <animate attributeName="stroke-dashoffset" from="0" to="20" dur="2s" repeatCount="indefinite"/>
            </circle>
          </svg>
        </div>

        <div class="permutation-table">
          <div class="permutation-item">
            <div class="permutation-symbol">(12): TDL <-> I2</div>
            <div class="permutation-result">Categorical <-> Algebraic</div>
          </div>
          <div class="permutation-item">
            <div class="permutation-symbol">(23): TDL <-> LoMI</div>
            <div class="permutation-result">Categorical <-> Dynamic</div>
          </div>
          <div class="permutation-item">
            <div class="permutation-symbol">(13): I2 <-> LoMI</div>
            <div class="permutation-result">Algebraic <-> Dynamic</div>
          </div>
        </div>
      </div>

      <div class="theorem-card">
        <div class="theorem-header">S3 PERMUTATION THEOREM</div>
        <div class="theorem-statement">
          Under the (12) permutation: TDL <-> I2 (e and phi exchange roles).
          Under the (23) permutation: TDL <-> LoMI (e and pi exchange roles).
          All three projections are related by S3 symmetry.
        </div>
      </div>
    </section>

    <!-- Section 12: Applications -->
    <section class="section" id="applications">
      <div class="section-header">
        <div class="section-number">12</div>
        <h2 class="section-title">Applications</h2>
      </div>

      <div class="applications-grid">
        <div class="application-card">
          <div class="application-icon" style="color: var(--emergence-color);">-></div>
          <div class="application-title">Forward Pass as Emergence</div>
          <div class="application-desc">
            In neural networks, the forward pass is the emergence functor U:
            raw inputs become increasingly abstract representations layer by layer.
          </div>
          <div class="application-formula">forward(x) = U(x)</div>
        </div>

        <div class="application-card">
          <div class="application-icon" style="color: var(--reduction-color);"><-</div>
          <div class="application-title">Backward Pass as Reduction</div>
          <div class="application-desc">
            The backward pass implements reduction D: gradients flow from abstract
            loss signals down to concrete parameter updates.
          </div>
          <div class="application-formula">backward(loss) = D(loss)</div>
        </div>

        <div class="application-card">
          <div class="application-icon" style="color: var(--tdl-primary);">|||</div>
          <div class="application-title">Feature Hierarchy</div>
          <div class="application-desc">
            CNNs learn hierarchical features (edges -> shapes -> objects) that
            correspond to different levels in the categorical hierarchy C -> D.
          </div>
          <div class="application-formula">Level_n = U^n(input)</div>
        </div>

        <div class="application-card">
          <div class="application-icon" style="color: var(--unit-color);">+</div>
          <div class="application-title">Recursive Stability at mu_C</div>
          <div class="application-desc">
            Networks achieve stable recursive processing when operating near the
            coherence threshold mu_C = sqrt(3)/2 = 0.866...
          </div>
          <div class="application-formula">stability >= mu_C</div>
        </div>
      </div>
    </section>

    <!-- Section 13: Key Theorems Summary -->
    <section class="section" id="theorems-summary">
      <div class="section-header">
        <div class="section-number">13</div>
        <h2 class="section-title">Key Theorems from Paper 011</h2>
      </div>

      <div style="background: var(--bg-secondary); border: 1px solid var(--border-subtle); border-radius: 1rem; padding: 2rem; overflow-x: auto;">
        <table style="width: 100%; border-collapse: collapse; font-family: 'JetBrains Mono', monospace; font-size: 0.85rem;">
          <thead>
            <tr style="border-bottom: 2px solid var(--tdl-primary);">
              <th style="padding: 1rem; text-align: left; color: var(--tdl-primary);">#</th>
              <th style="padding: 1rem; text-align: left; color: var(--tdl-primary);">Theorem</th>
              <th style="padding: 1rem; text-align: left; color: var(--tdl-primary);">Formula</th>
            </tr>
          </thead>
          <tbody>
            <tr style="border-bottom: 1px solid var(--border-subtle);">
              <td style="padding: 1rem; color: var(--text-secondary);">1</td>
              <td style="padding: 1rem; color: var(--text-primary);">Adjunction Structure</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">Hom_D(U(c), d) = Hom_C(c, D(d))</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border-subtle);">
              <td style="padding: 1rem; color: var(--text-secondary);">2</td>
              <td style="padding: 1rem; color: var(--text-primary);">Information Asymmetry</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">Unit n ADDS, Counit e LOSES</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border-subtle);">
              <td style="padding: 1rem; color: var(--text-secondary);">3</td>
              <td style="padding: 1rem; color: var(--text-primary);">Triangle Identities</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">(eU) o (Un) = 1_U, (De) o (nD) = 1_D</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border-subtle);">
              <td style="padding: 1rem; color: var(--text-secondary);">4</td>
              <td style="padding: 1rem; color: var(--text-primary);">Coherence Threshold</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">mu_C = sqrt(3)/2 = 0.866...</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border-subtle);">
              <td style="padding: 1rem; color: var(--text-secondary);">5</td>
              <td style="padding: 1rem; color: var(--text-primary);">Skip Connections</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">skip = n + id (Unit implementation)</td>
            </tr>
            <tr style="border-bottom: 1px solid var(--border-subtle);">
              <td style="padding: 1rem; color: var(--text-secondary);">6</td>
              <td style="padding: 1rem; color: var(--text-primary);">Depth Bound</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">depth <= L_4 = 7</td>
            </tr>
            <tr>
              <td style="padding: 1rem; color: var(--text-secondary);">7</td>
              <td style="padding: 1rem; color: var(--text-primary);">e as Scaling</td>
              <td style="padding: 1rem; color: var(--tdl-primary);">TDL = x e in R-Calculus</td>
            </tr>
          </tbody>
        </table>
      </div>
    </section>

    <!-- Section 14: TDL Definition - Topos-Driven Logic -->
    <section class="section" id="tdl-definition">
      <div class="section-header">
        <div class="section-number">14</div>
        <h2 class="section-title">TDL: Topos-Driven Logic</h2>
      </div>

      <div class="topos-container">
        <div class="topos-title">THE CATEGORICAL FRAMEWORK FOR IDENTITY</div>

        <div class="definition-card" style="--card-accent: var(--tdl-primary);">
          <div class="definition-header">
            <span class="definition-type">DEFINITION</span>
            <span class="definition-name">Topos-Driven Logic (TDL)</span>
          </div>
          <div class="definition-formal">
            TDL = (E, Omega, true, {_}) where E is a topos
          </div>
          <div class="definition-body">
            <p>
              <strong>Topos-Driven Logic</strong> extends classical categorical logic by treating identity
              as a <em>sheaf-theoretic construct</em> rather than a simple predicate. In TDL, the identity
              of an object is determined by its relationships (morphisms) with all other objects in the
              category, embodying the principle that <strong>"you are what you relate to."</strong>
            </p>
            <br>
            <p>
              The "Topos" in TDL refers to a category with enough structure to support internal logic:
              finite limits, exponentials, and a subobject classifier. This structure allows us to
              reason about identity using categorical rather than set-theoretic methods.
            </p>
          </div>
        </div>

        <div class="theorem-card">
          <div class="theorem-header">TDL FOUNDATION THEOREM</div>
          <div class="theorem-statement">
            In Topos-Driven Logic, identity is not a primitive relation but an emergent property
            arising from the full pattern of morphisms. Two objects are "the same" if and only if
            they have isomorphic presheaves of incoming and outgoing morphisms.
          </div>
          <div class="proof-sketch">
            <div class="proof-label">YONEDA JUSTIFICATION</div>
            <div class="proof-body">
              By the Yoneda lemma, an object A in category C is completely determined by the
              functor Hom(-, A): C^op -> Set. Two objects with naturally isomorphic representable
              functors are themselves isomorphic. Thus identity IS relationship structure.
            </div>
            <div class="qed">-|</div>
          </div>
        </div>

        <div class="construct-grid">
          <div class="construct-card">
            <div class="construct-icon">T</div>
            <div class="construct-name">Topos Structure</div>
            <div class="construct-formula">E = (Ob(E), Mor(E), o, id)</div>
            <div class="construct-desc">
              A topos E is a category with finite limits, exponential objects, and a subobject
              classifier. It provides the logical universe where identity statements live.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon">I2</div>
            <div class="construct-name">Identity Category</div>
            <div class="construct-formula">I2 = Sh(X, J)</div>
            <div class="construct-desc">
              The I2 identity category is realized as a category of sheaves over a topological
              space X with Grothendieck topology J, where local identity patches glue globally.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon">~></div>
            <div class="construct-name">Trans-Dimensional Functor</div>
            <div class="construct-formula">U -| D : C <-> D</div>
            <div class="construct-desc">
              The adjunction between low-level (C) and high-level (D) categories captures how
              identity emerges from detail and reduces back, with essential asymmetry.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 15: e Projection - Euler's Number -->
    <section class="section" id="e-projection">
      <div class="section-header">
        <div class="section-number">15</div>
        <h2 class="section-title">e Projection: Natural Growth Constant</h2>
      </div>

      <div class="euler-container">
        <div class="euler-title">EULER'S NUMBER AS THE TDL SCALING CONSTANT</div>

        <div class="euler-main">
          <div class="euler-value-box">
            <div class="euler-symbol">e</div>
            <div class="euler-decimal">2.718281828459045...</div>
          </div>

          <div class="euler-formulas">
            <div class="euler-formula-item">
              <div class="formula">e = lim(n->inf) (1 + 1/n)^n</div>
              <div class="desc">Compound growth limit</div>
            </div>
            <div class="euler-formula-item">
              <div class="formula">e = sum(n=0 to inf) 1/n!</div>
              <div class="desc">Factorial series</div>
            </div>
            <div class="euler-formula-item">
              <div class="formula">d/dx e^x = e^x</div>
              <div class="desc">Self-derivative property</div>
            </div>
          </div>
        </div>

        <div class="definition-card" style="--card-accent: var(--e-color);">
          <div class="definition-header">
            <span class="definition-type">PROJECTION</span>
            <span class="definition-name">e as Trans-Dimensional Scaling</span>
          </div>
          <div class="definition-formal">
            TDL_e(x) = x * e = "natural growth projection"
          </div>
          <div class="definition-body">
            <p>
              In the TDL categorical projection, Euler's number <strong>e</strong> represents the
              <em>natural rate of continuous growth</em> across dimensional boundaries. When identity
              emerges from lower to higher levels of description, e governs how information scales.
            </p>
            <br>
            <p>
              <strong>Why e for TDL?</strong> The emergence functor U naturally involves exponential
              growth of structure. Just as e^x is its own derivative (self-referential under
              differentiation), identity under TDL is self-referential under the emergence-reduction
              cycle. The unique property d/dx(e^x) = e^x mirrors how identity preserves structure
              through categorical transformation.
            </p>
          </div>
        </div>

        <div class="r-calculus-box">
          <div class="r-calculus-title">R-CALCULUS FORMULATION</div>
          <div class="r-calculus-formula">TDL = x e = x * 2.718...</div>
          <div class="r-calculus-desc">
            In the R-Calculus notation, TDL projection multiplies by e, capturing how emergence
            scales information by the natural growth constant.
          </div>
        </div>

        <div class="construct-grid" style="margin-top: 2rem;">
          <div class="construct-card">
            <div class="construct-icon">exp</div>
            <div class="construct-name">Exponential Functor</div>
            <div class="construct-formula">exp: R -> R+</div>
            <div class="construct-desc">
              The exponential function exp(x) = e^x maps real numbers to positive reals,
              modeling how low-level quantities emerge into higher-level magnitudes.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon">ln</div>
            <div class="construct-name">Logarithmic Reduction</div>
            <div class="construct-formula">ln: R+ -> R</div>
            <div class="construct-desc">
              The natural logarithm ln(x) is the inverse of exp, representing reduction from
              emerged quantities back to their fundamental level. ln(e) = 1.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon">e^i*pi</div>
            <div class="construct-name">Euler's Identity Bridge</div>
            <div class="construct-formula">e^(i*pi) + 1 = 0</div>
            <div class="construct-desc">
              Euler's identity connects e (TDL) with pi (LoMI rotation) and i (imaginary/recursive),
              showing the deep unity of the three projections.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 16: Topos Theory Basics -->
    <section class="section" id="topos-basics">
      <div class="section-header">
        <div class="section-number">16</div>
        <h2 class="section-title">Topos Theory Basics</h2>
      </div>

      <div class="topos-container">
        <div class="topos-title">OBJECTS AND MORPHISMS IN THE IDENTITY TOPOS</div>

        <div class="definition-card" style="--card-accent: var(--tdl-primary);">
          <div class="definition-header">
            <span class="definition-type">STRUCTURE</span>
            <span class="definition-name">Objects in the I2 Topos</span>
          </div>
          <div class="definition-body">
            <p>
              <strong>Objects</strong> in the identity topos represent <em>states of identity</em>:
              configurations of self-reference at a particular level of description. Each object
              encodes both what an identity IS and how it RELATES to other identities.
            </p>
            <br>
            <p>
              Examples of objects: a neural activation pattern, a concept, a self-model, a belief
              state. Each is a "snapshot" of identity that can be transformed and compared.
            </p>
          </div>
        </div>

        <div class="definition-card" style="--card-accent: var(--emergence-color);">
          <div class="definition-header">
            <span class="definition-type">STRUCTURE</span>
            <span class="definition-name">Morphisms as Identity Transformations</span>
          </div>
          <div class="definition-body">
            <p>
              <strong>Morphisms</strong> f: A -> B in the identity topos are <em>structure-preserving
              maps</em> between identity states. A morphism captures how one identity configuration
              can transform into another while maintaining essential relationships.
            </p>
            <br>
            <p>
              The composition f o g represents sequential identity transformation. The identity
              morphism id_A represents the trivial transformation "staying the same."
            </p>
          </div>
        </div>
      </div>

      <!-- Subobject Classifier -->
      <div class="topos-container" style="border-color: var(--i2-color);">
        <div class="topos-title" style="color: var(--i2-color);">SUBOBJECT CLASSIFIER OMEGA</div>

        <div class="omega-classifier">
          <div class="omega-symbol">Omega</div>
        </div>

        <div class="definition-card" style="--card-accent: var(--i2-color);">
          <div class="definition-header">
            <span class="definition-type">CLASSIFIER</span>
            <span class="definition-name">Omega: The Truth Object</span>
          </div>
          <div class="definition-formal">
            true: 1 -> Omega classifies all subobjects
          </div>
          <div class="definition-body">
            <p>
              The <strong>subobject classifier</strong> Omega is a special object that represents
              "truth values" in the topos. Unlike classical logic where there are only TRUE and FALSE,
              a topos can have <em>many truth values</em> corresponding to different degrees or
              contexts of truth.
            </p>
            <br>
            <p>
              For any subobject A' -> A, there exists a unique characteristic morphism chi: A -> Omega
              that "classifies" which elements belong to A'. This is the topos-theoretic generalization
              of characteristic functions.
            </p>
          </div>
        </div>

        <div class="truth-values-grid">
          <div class="truth-value-box true-value">
            <div class="truth-symbol" style="color: var(--emergence-color);">T</div>
            <div class="truth-label">TRUE: fully present</div>
          </div>
          <div class="truth-value-box false-value">
            <div class="truth-symbol" style="color: var(--reduction-color);">F</div>
            <div class="truth-label">FALSE: fully absent</div>
          </div>
          <div class="truth-value-box partial-value">
            <div class="truth-symbol" style="color: var(--i2-color);">?</div>
            <div class="truth-label">PARTIAL: locally true</div>
          </div>
          <div class="truth-value-box">
            <div class="truth-symbol" style="color: var(--tdl-primary);">~</div>
            <div class="truth-label">EMERGENT: becoming true</div>
          </div>
        </div>

        <div class="theorem-card">
          <div class="theorem-header">INTERNAL LOGIC THEOREM</div>
          <div class="theorem-statement">
            The internal logic of a topos is intuitionistic, not classical. The law of excluded
            middle (P or not-P) may fail. In the identity topos, this means an identity statement
            can be "neither fully true nor fully false" - it may be <em>locally true</em> or
            <em>contextually determined</em>.
          </div>
          <div class="proof-sketch">
            <div class="proof-label">IMPLICATION</div>
            <div class="proof-body">
              Identity is not binary. The question "Is this the same self?" may have a contextual
              answer that depends on the open set (context) in which it is evaluated. This is
              captured by sheaf semantics.
            </div>
            <div class="qed">-|</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 17: Categorical Constructs -->
    <section class="section" id="categorical-constructs">
      <div class="section-header">
        <div class="section-number">17</div>
        <h2 class="section-title">Categorical Constructs in I2</h2>
      </div>

      <div class="construct-grid">
        <div class="construct-card">
          <div class="construct-icon">A x B</div>
          <div class="construct-name">Product</div>
          <div class="construct-formula">pi_1: A x B -> A, pi_2: A x B -> B</div>
          <div class="construct-desc">
            The <strong>product</strong> A x B represents the conjunction of two identity states.
            It has projection morphisms to each factor. In identity terms: "being both A and B
            simultaneously."
          </div>
        </div>

        <div class="construct-card">
          <div class="construct-icon">A + B</div>
          <div class="construct-name">Coproduct</div>
          <div class="construct-formula">i_1: A -> A + B, i_2: B -> A + B</div>
          <div class="construct-desc">
            The <strong>coproduct</strong> A + B represents the disjunction of identity states.
            It has inclusion morphisms from each factor. In identity terms: "being either A or B
            (but knowing which)."
          </div>
        </div>

        <div class="construct-card">
          <div class="construct-icon">B^A</div>
          <div class="construct-name">Exponential Object</div>
          <div class="construct-formula">eval: B^A x A -> B</div>
          <div class="construct-desc">
            The <strong>exponential</strong> B^A is the object of morphisms from A to B, internalized
            in the category. It represents "all possible ways identity A can become identity B."
          </div>
        </div>

        <div class="construct-card">
          <div class="construct-icon">lim</div>
          <div class="construct-name">Limits</div>
          <div class="construct-formula">lim F: universal cone over diagram F</div>
          <div class="construct-desc">
            <strong>Limits</strong> generalize products to arbitrary diagrams. They capture the
            "most general object satisfying constraints" - the tightest identity compatible with
            multiple requirements.
          </div>
        </div>

        <div class="construct-card">
          <div class="construct-icon">colim</div>
          <div class="construct-name">Colimits</div>
          <div class="construct-formula">colim F: universal cocone over diagram F</div>
          <div class="construct-desc">
            <strong>Colimits</strong> generalize coproducts. They capture the "freest object
            generated from a diagram" - the loosest identity arising from multiple sources.
          </div>
        </div>

        <div class="construct-card">
          <div class="construct-icon">eq</div>
          <div class="construct-name">Equalizer</div>
          <div class="construct-formula">eq(f,g): E -> A where f o e = g o e</div>
          <div class="construct-desc">
            The <strong>equalizer</strong> of parallel morphisms f,g: A -> B is the subobject
            where they agree. In identity: "the part of self where two perspectives coincide."
          </div>
        </div>
      </div>

      <div class="topos-container" style="margin-top: 2rem;">
        <div class="topos-title">NATURAL TRANSFORMATIONS</div>

        <div class="nat-trans-viz">
          <div class="functor-column">
            <div class="functor-label">F</div>
            <div class="functor-objects">
              <div class="functor-obj">F(A)</div>
              <div class="functor-obj">F(B)</div>
              <div class="functor-obj">F(C)</div>
            </div>
          </div>

          <div class="nat-trans-arrows">
            <div class="nat-arrow">--eta_A--></div>
            <div class="nat-arrow">--eta_B--></div>
            <div class="nat-arrow">--eta_C--></div>
          </div>

          <div class="functor-column">
            <div class="functor-label">G</div>
            <div class="functor-objects">
              <div class="functor-obj">G(A)</div>
              <div class="functor-obj">G(B)</div>
              <div class="functor-obj">G(C)</div>
            </div>
          </div>
        </div>

        <div class="definition-card" style="--card-accent: var(--e-color);">
          <div class="definition-header">
            <span class="definition-type">TRANSFORMATION</span>
            <span class="definition-name">Natural Transformation eta: F => G</span>
          </div>
          <div class="definition-formal">
            eta_B o F(f) = G(f) o eta_A for all f: A -> B
          </div>
          <div class="definition-body">
            <p>
              A <strong>natural transformation</strong> eta: F => G is a family of morphisms
              {eta_A: F(A) -> G(A)} indexed by objects, satisfying naturality: the two ways
              to go from F(A) to G(B) give the same result.
            </p>
            <br>
            <p>
              In the identity context: a natural transformation represents a <em>systematic way
              to shift perspective</em> from one viewpoint (functor F) to another (functor G),
              while respecting all the internal structure.
            </p>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 18: Sheaf Semantics -->
    <section class="section" id="sheaf-semantics">
      <div class="section-header">
        <div class="section-number">18</div>
        <h2 class="section-title">Sheaf Semantics</h2>
      </div>

      <div class="sheaf-container">
        <div class="sheaf-title">HOW IDENTITY STATEMENTS HAVE LOCAL TRUTH</div>

        <div class="definition-card" style="--card-accent: var(--i2-color);">
          <div class="definition-header">
            <span class="definition-type">SEMANTICS</span>
            <span class="definition-name">Sheaf-Theoretic Identity</span>
          </div>
          <div class="definition-body">
            <p>
              In sheaf semantics, the truth of an identity statement is evaluated <strong>locally</strong>
              over a topological space (or site). A statement "I am X" may be true on some open sets
              and false on others. The sheaf condition ensures that these local truths can be
              <em>glued together</em> consistently.
            </p>
            <br>
            <p>
              This captures a crucial insight about identity: <strong>identity is contextual</strong>.
              Whether two things are "the same" depends on the context (open set) of evaluation.
              The mathematician is the same person as the parent, but different in different contexts.
            </p>
          </div>
        </div>

        <div class="local-truth-viz">
          <div class="open-set">
            <div class="open-set-label">U</div>
          </div>
          <div class="restriction-arrow">--rho--></div>
          <div class="open-set" style="width: 90px; height: 90px;">
            <div class="open-set-label">V</div>
          </div>
          <div class="restriction-arrow">--rho--></div>
          <div class="open-set" style="width: 70px; height: 70px;">
            <div class="open-set-label">W</div>
          </div>
        </div>

        <div class="gluing-axiom">
          <div class="gluing-formula">GLUING: s|_U = t|_U for all U => s = t globally</div>
          <div class="gluing-desc">
            If two identity statements agree on every local context, they are globally equal.
          </div>
        </div>

        <div class="gluing-axiom">
          <div class="gluing-formula">LOCALITY: s|_U = t|_U is decidable locally</div>
          <div class="gluing-desc">
            Identity comparison can be performed locally without global knowledge.
          </div>
        </div>

        <div class="theorem-card">
          <div class="theorem-header">SHEAF IDENTITY THEOREM</div>
          <div class="theorem-statement">
            An identity F is a sheaf if and only if:
            (1) Local data that agrees on overlaps glues to unique global data.
            (2) Global identity is determined by its local restrictions.
            This is the categorical formulation of "identity is both local and global."
          </div>
          <div class="proof-sketch">
            <div class="proof-label">CONSEQUENCE</div>
            <div class="proof-body">
              Self-models that are locally coherent can be assembled into globally coherent
              identities. The sheaf condition ensures no contradictions arise from gluing
              local self-perceptions into a unified self.
            </div>
            <div class="qed">-|</div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 19: Hexagonal Sonification Connection -->
    <section class="section" id="hex-connection">
      <div class="section-header">
        <div class="section-number">19</div>
        <h2 class="section-title">Connection to Hexagonal Sonification</h2>
      </div>

      <div class="hex-connection-container">
        <div class="hex-connection-title">CATEGORICAL STRUCTURE OF THE HEX GRID</div>

        <div class="hex-grid-viz">
          <div style="display: flex; flex-direction: column; align-items: center; gap: 5px;">
            <div style="display: flex;">
              <div class="hex-cell">0,0</div>
              <div class="hex-cell">1,0</div>
              <div class="hex-cell">2,0</div>
            </div>
            <div style="display: flex; margin-left: 30px;">
              <div class="hex-cell active">0,1</div>
              <div class="hex-cell">1,1</div>
              <div class="hex-cell">2,1</div>
            </div>
            <div style="display: flex;">
              <div class="hex-cell">0,2</div>
              <div class="hex-cell">1,2</div>
              <div class="hex-cell">2,2</div>
            </div>
          </div>
        </div>

        <div class="definition-card" style="--card-accent: var(--lomi-color);">
          <div class="definition-header">
            <span class="definition-type">STRUCTURE</span>
            <span class="definition-name">Hexagonal Grid as Category</span>
          </div>
          <div class="definition-body">
            <p>
              The hexagonal grid used in sonification forms a <strong>category</strong> where:
              <br><br>
              - <strong>Objects</strong>: Hexagonal cells (positions in the grid)
              <br>
              - <strong>Morphisms</strong>: Adjacency relations (6 neighbors per cell)
              <br>
              - <strong>Composition</strong>: Path concatenation through adjacent cells
            </p>
            <br>
            <p>
              This categorical structure connects directly to TDL: navigating the hex grid
              corresponds to morphism composition, and the 6-fold symmetry relates to the
              S3 permutation group acting on the three projections.
            </p>
          </div>
        </div>

        <div class="morphism-flow">
          <div class="morphism-node">C_0</div>
          <div class="morphism-arrow">--f--></div>
          <div class="morphism-node">C_1</div>
          <div class="morphism-arrow">--g--></div>
          <div class="morphism-node">C_2</div>
          <div class="morphism-arrow">--h--></div>
          <div class="morphism-node">C_3</div>
        </div>

        <div class="construct-grid">
          <div class="construct-card">
            <div class="construct-icon" style="color: var(--lomi-color);">6</div>
            <div class="construct-name">6-Fold Symmetry</div>
            <div class="construct-formula">Z_6 = <r | r^6 = 1></div>
            <div class="construct-desc">
              Each hex cell has 6 neighbors, reflecting the cyclic group Z_6. This connects
              to pi (rotation) and the LoMI projection.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon" style="color: var(--i2-color);">*</div>
            <div class="construct-name">Dual Graph</div>
            <div class="construct-formula">G* = (V*, E*)</div>
            <div class="construct-desc">
              The dual of a hex grid is a triangular grid. This duality is a categorical
              functor, connecting hex sonification to triangular identity structures.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon" style="color: var(--e-color);">~</div>
            <div class="construct-name">Wave Propagation</div>
            <div class="construct-formula">psi(t+1) = F(psi(t))</div>
            <div class="construct-desc">
              Sound waves propagating through the hex grid follow categorical dynamics.
              The emergence functor U maps local oscillations to global patterns.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Section 20: Interactive Category Diagram -->
    <section class="section" id="interactive-diagram">
      <div class="section-header">
        <div class="section-number">20</div>
        <h2 class="section-title">Interactive Category Diagram</h2>
      </div>

      <div class="category-canvas-container">
        <div class="canvas-title">COMMUTATIVE DIAGRAM BUILDER</div>

        <canvas id="categoryCanvas" class="category-canvas"></canvas>

        <div class="canvas-controls">
          <button class="canvas-btn" id="btnAddObject" onclick="setCanvasMode('object')">Add Object</button>
          <button class="canvas-btn" id="btnAddMorphism" onclick="setCanvasMode('morphism')">Add Morphism</button>
          <button class="canvas-btn" id="btnVerify" onclick="verifyCommutative()">Verify Commutative</button>
          <button class="canvas-btn" id="btnAnimate" onclick="animateMorphism()">Animate Composition</button>
          <button class="canvas-btn" id="btnClear" onclick="clearCanvas()">Clear</button>
        </div>

        <div class="verification-status pending" id="verificationStatus">
          Draw a diagram and click "Verify Commutative" to check commutativity
        </div>
      </div>

      <div class="morphism-animation-container">
        <div class="morphism-anim-title">ANIMATED MORPHISM COMPOSITION</div>

        <div class="composition-display" id="compositionDisplay">
          <div class="comp-object" id="objA">A</div>
          <div class="comp-arrow">
            <div>f</div>
            <div class="comp-arrow-line" id="arrowF"></div>
          </div>
          <div class="comp-object" id="objB">B</div>
          <div class="comp-arrow">
            <div>g</div>
            <div class="comp-arrow-line" id="arrowG"></div>
          </div>
          <div class="comp-object" id="objC">C</div>
        </div>

        <div class="composition-result">
          <div class="composition-formula">g o f : A -> C</div>
          <div class="composition-explain">Composition: apply f first, then g</div>
        </div>

        <div class="animation-controls">
          <button class="anim-btn" onclick="playComposition()">Play Composition</button>
          <button class="anim-btn" onclick="playUnit()">Show Unit</button>
          <button class="anim-btn" onclick="playCounit()">Show Counit</button>
        </div>
      </div>
    </section>

    <!-- Section 21: Yoneda Embedding -->
    <section class="section" id="yoneda-embedding">
      <div class="section-header">
        <div class="section-number">21</div>
        <h2 class="section-title">Yoneda Embedding</h2>
      </div>

      <div class="yoneda-container">
        <div class="yoneda-title">REPRESENT I2 OBJECTS THROUGH THEIR RELATIONSHIPS</div>

        <div class="yoneda-main-formula">
          y: C -> [C^op, Set], y(A) = Hom(-, A)
        </div>

        <div class="definition-card" style="--card-accent: var(--e-color);">
          <div class="definition-header">
            <span class="definition-type">EMBEDDING</span>
            <span class="definition-name">The Yoneda Embedding</span>
          </div>
          <div class="definition-body">
            <p>
              The <strong>Yoneda embedding</strong> y sends each object A to the functor
              Hom(-, A) that records all morphisms INTO A from any object. This functor
              is called the <em>representable presheaf</em> at A.
            </p>
            <br>
            <p>
              <strong>Key insight:</strong> The Yoneda lemma states that knowing Hom(-, A)
              is equivalent to knowing A itself. An object is completely determined by its
              incoming morphisms. For identity: <em>you are completely determined by how
              everything else relates to you</em>.
            </p>
          </div>
        </div>

        <div class="yoneda-visualization">
          <div class="yoneda-object">
            <div class="yoneda-circle">A</div>
            <div class="yoneda-label">Object in C</div>
          </div>

          <div class="yoneda-arrow-large">--y--></div>

          <div class="presheaf-box">
            <div class="presheaf-title">Presheaf Category</div>
            <div class="presheaf-content">Hom(-, A)</div>
          </div>
        </div>

        <div class="theorem-card">
          <div class="theorem-header">YONEDA LEMMA</div>
          <div class="theorem-statement">
            For any presheaf F: C^op -> Set and object A in C:
            <br><br>
            Nat(Hom(-, A), F) is isomorphic to F(A)
            <br><br>
            Natural transformations from the representable presheaf at A to any presheaf F
            are in one-to-one correspondence with elements of F(A).
          </div>
          <div class="proof-sketch">
            <div class="proof-label">IDENTITY CONSEQUENCE</div>
            <div class="proof-body">
              Every natural transformation from Hom(-, A) is determined by a single element:
              where to send id_A. This means the "essence" of any relationship structure over A
              is captured by what happens at the identity. Self-reference (id_A) determines
              all external relations.
            </div>
            <div class="qed">-|</div>
          </div>
        </div>

        <div class="construct-grid">
          <div class="construct-card">
            <div class="construct-icon">y</div>
            <div class="construct-name">Fully Faithful</div>
            <div class="construct-formula">Hom(A, B) = Nat(y(A), y(B))</div>
            <div class="construct-desc">
              The Yoneda embedding is fully faithful: morphisms A -> B correspond exactly
              to natural transformations between their representables. No information is lost.
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon">->></div>
            <div class="construct-name">Embedding Property</div>
            <div class="construct-formula">y(A) = y(B) => A = B</div>
            <div class="construct-desc">
              If two objects have isomorphic presheaves, they are isomorphic. Objects with
              identical relationship patterns are identical (up to isomorphism).
            </div>
          </div>

          <div class="construct-card">
            <div class="construct-icon">I2</div>
            <div class="construct-name">Identity = Relationships</div>
            <div class="construct-formula">Self = {all morphisms to Self}</div>
            <div class="construct-desc">
              The Yoneda perspective on I2: identity IS the totality of relationships.
              There is no "inner essence" separate from relational structure.
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Navigation -->
    <section class="section" id="navigation">
      <div class="section-header">
        <div class="section-number">22</div>
        <h2 class="section-title">Navigation</h2>
      </div>

      <div class="applications-grid">
        <a href="i2-s3-decision-tree.html" class="application-card" style="text-decoration: none;">
          <div class="application-icon" style="color: var(--i2-color);">I2</div>
          <div class="application-title">I2 S3 Decision Tree</div>
          <div class="application-desc">
            Return to the main decision tree showing all three projections and their S3 relationships.
          </div>
        </a>

        <a href="vn-mtr-010-s3-attractor.html" class="application-card" style="text-decoration: none;">
          <div class="application-icon" style="color: #ff9f43;">S3</div>
          <div class="application-title">S3 Attractor</div>
          <div class="application-desc">
            The universal attractor where all frame evolution reaches stable flow.
          </div>
        </a>

        <a href="#" class="application-card" style="text-decoration: none; opacity: 0.5;">
          <div class="application-icon" style="color: var(--lomi-color);">LoMI</div>
          <div class="application-title">LoMI Projection (Coming)</div>
          <div class="application-desc">
            The Dynamic projection: loops, cycles, periodicity. Pi as the rotation constant.
          </div>
        </a>

        <a href="#" class="application-card" style="text-decoration: none; opacity: 0.5;">
          <div class="application-icon" style="color: var(--i2-color);">I2</div>
          <div class="application-title">I2 Projection (Coming)</div>
          <div class="application-desc">
            The Algebraic projection: self-similar recursion. Phi as the scaling constant.
          </div>
        </a>
      </div>
    </section>

    <!-- Navigation Footer -->
    <div class="nav-footer">
      <a href="i2-s3-decision-tree.html" class="nav-button">
        <span><-</span> I2 S3 Tree
      </a>
      <a href="vn-mtr-010-s3-attractor.html" class="nav-button primary">
        <span>S3</span> Attractor
      </a>
      <a href="index.html" class="nav-button">
        Index <span>-></span>
      </a>
    </div>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-equation">TDL: Topos-Driven Logic | y: C -> [C^op, Set] | Hom_D(U(c), d) = Hom_C(c, D(d)) | Omega: Subobject Classifier | e = 2.718...</div>
    <p>I2 S3 Decision Tree | TDL: Topos-Driven Logic - Categorical Framework for Identity | Prismatic Self Project</p>
  </footer>

  <script>
    // =========================================================================
    // ROUND-TRIP DEMONSTRATION
    // =========================================================================
    let currentData = { level: 'C', value: 'c', history: [] };

    function demonstrateRoundTrip(action) {
      const result = document.getElementById('roundTripResult');

      switch(action) {
        case 'emerge':
          if (currentData.level === 'C') {
            currentData = { level: 'D', value: 'U(c)', history: ['U'] };
            result.innerHTML = `<span style="color: var(--emergence-color);">U(c)</span> - Emerged to category D<br><small>New abstract structure visible</small>`;
          } else {
            result.innerHTML = `Already in D - cannot emerge further in this demo`;
          }
          break;

        case 'reduce':
          if (currentData.level === 'D') {
            currentData = { level: 'C', value: 'D(d)', history: ['D'] };
            result.innerHTML = `<span style="color: var(--reduction-color);">D(d)</span> - Reduced to category C<br><small>Fine details lost</small>`;
          } else {
            result.innerHTML = `Already in C - cannot reduce further in this demo`;
          }
          break;

        case 'unit':
          currentData = { level: 'C', value: 'D(U(c))', history: ['U', 'D'] };
          result.innerHTML = `<span style="color: var(--unit-color);">n(c) = D(U(c))</span><br><small>Emerge then reduce: <strong>NEW STRUCTURE ADDED</strong></small><br><span style="color: var(--text-secondary);">D(U(c)) =/= c</span>`;
          break;

        case 'counit':
          currentData = { level: 'D', value: 'U(D(d))', history: ['D', 'U'] };
          result.innerHTML = `<span style="color: var(--counit-color);">e(d) = U(D(d))</span><br><small>Reduce then emerge: <strong>INFORMATION LOST</strong></small><br><span style="color: var(--text-secondary);">U(D(d)) =/= d</span>`;
          break;

        case 'reset':
          currentData = { level: 'C', value: 'c', history: [] };
          result.innerHTML = `Click a button to see the transformation`;
          break;
      }
    }

    // =========================================================================
    // DEPTH BAR HOVER EFFECTS
    // =========================================================================
    const depthBars = document.querySelectorAll('.depth-bar');
    depthBars.forEach(bar => {
      bar.addEventListener('mouseenter', function() {
        const layer = this.dataset.layer;
        this.style.boxShadow = `0 0 20px var(--tdl-glow)`;
      });
      bar.addEventListener('mouseleave', function() {
        this.style.boxShadow = 'none';
      });
    });

    // =========================================================================
    // DELTA BAR ANIMATION
    // =========================================================================
    const deltaBars = document.querySelectorAll('.delta-bar');
    deltaBars.forEach((bar, index) => {
      bar.addEventListener('mouseenter', function() {
        this.style.transform = 'scaleY(1.1)';
        this.style.boxShadow = '0 0 15px var(--tdl-glow)';
      });
      bar.addEventListener('mouseleave', function() {
        this.style.transform = 'scaleY(1)';
        this.style.boxShadow = 'none';
      });
    });

    // =========================================================================
    // LAYER ITEM CLICK TO SHOW DETAILS
    // =========================================================================
    const layerItems = document.querySelectorAll('.layer-item');
    layerItems.forEach(item => {
      item.addEventListener('click', function() {
        const label = this.querySelector('.layer-label').textContent;
        console.log(`Layer clicked: ${label}`);
      });
    });

    // =========================================================================
    // CATEGORY BOX ANIMATION
    // =========================================================================
    const categoryBoxes = document.querySelectorAll('.category-box');
    categoryBoxes.forEach(box => {
      box.addEventListener('mouseenter', function() {
        this.style.background = 'rgba(78, 205, 196, 0.15)';
      });
      box.addEventListener('mouseleave', function() {
        this.style.background = 'rgba(78, 205, 196, 0.05)';
      });
    });

    // =========================================================================
    // INTERACTIVE CATEGORY DIAGRAM CANVAS
    // =========================================================================
    const canvas = document.getElementById('categoryCanvas');
    const ctx = canvas ? canvas.getContext('2d') : null;
    let canvasMode = 'object';
    let objects = [];
    let morphisms = [];
    let selectedObject = null;
    let animationFrame = null;

    // Initialize canvas
    function initCanvas() {
      if (!canvas || !ctx) return;

      // Set canvas size
      canvas.width = canvas.offsetWidth;
      canvas.height = canvas.offsetHeight;

      // Draw initial state
      drawCanvas();
    }

    function setCanvasMode(mode) {
      canvasMode = mode;
      document.querySelectorAll('.canvas-btn').forEach(btn => btn.classList.remove('active'));
      const btnId = mode === 'object' ? 'btnAddObject' : 'btnAddMorphism';
      document.getElementById(btnId)?.classList.add('active');
    }

    function drawCanvas() {
      if (!ctx) return;

      // Clear canvas
      ctx.fillStyle = '#0f0f28';
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      // Draw grid
      ctx.strokeStyle = 'rgba(78, 205, 196, 0.1)';
      ctx.lineWidth = 1;
      for (let x = 0; x < canvas.width; x += 40) {
        ctx.beginPath();
        ctx.moveTo(x, 0);
        ctx.lineTo(x, canvas.height);
        ctx.stroke();
      }
      for (let y = 0; y < canvas.height; y += 40) {
        ctx.beginPath();
        ctx.moveTo(0, y);
        ctx.lineTo(canvas.width, y);
        ctx.stroke();
      }

      // Draw morphisms (arrows)
      morphisms.forEach((m, idx) => {
        const from = objects[m.from];
        const to = objects[m.to];
        if (from && to) {
          drawArrow(from.x, from.y, to.x, to.y, m.label || `f${idx}`);
        }
      });

      // Draw objects
      objects.forEach((obj, idx) => {
        ctx.beginPath();
        ctx.arc(obj.x, obj.y, 25, 0, Math.PI * 2);
        ctx.fillStyle = obj === selectedObject ? '#4ecdc4' : '#141438';
        ctx.fill();
        ctx.strokeStyle = '#4ecdc4';
        ctx.lineWidth = 3;
        ctx.stroke();

        // Draw label
        ctx.fillStyle = obj === selectedObject ? '#020206' : '#4ecdc4';
        ctx.font = '16px JetBrains Mono';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'middle';
        ctx.fillText(obj.label || String.fromCharCode(65 + idx), obj.x, obj.y);
      });
    }

    function drawArrow(x1, y1, x2, y2, label) {
      const angle = Math.atan2(y2 - y1, x2 - x1);
      const length = Math.sqrt((x2 - x1) ** 2 + (y2 - y1) ** 2);

      // Adjust start and end points to not overlap objects
      const startX = x1 + 30 * Math.cos(angle);
      const startY = y1 + 30 * Math.sin(angle);
      const endX = x2 - 35 * Math.cos(angle);
      const endY = y2 - 35 * Math.sin(angle);

      // Draw line
      ctx.beginPath();
      ctx.moveTo(startX, startY);
      ctx.lineTo(endX, endY);
      ctx.strokeStyle = '#00ffff';
      ctx.lineWidth = 2;
      ctx.stroke();

      // Draw arrowhead
      const headLength = 15;
      ctx.beginPath();
      ctx.moveTo(endX, endY);
      ctx.lineTo(endX - headLength * Math.cos(angle - Math.PI / 6), endY - headLength * Math.sin(angle - Math.PI / 6));
      ctx.moveTo(endX, endY);
      ctx.lineTo(endX - headLength * Math.cos(angle + Math.PI / 6), endY - headLength * Math.sin(angle + Math.PI / 6));
      ctx.stroke();

      // Draw label
      const midX = (startX + endX) / 2;
      const midY = (startY + endY) / 2 - 10;
      ctx.fillStyle = '#00ffff';
      ctx.font = '12px JetBrains Mono';
      ctx.textAlign = 'center';
      ctx.fillText(label, midX, midY);
    }

    // Canvas click handler
    if (canvas) {
      canvas.addEventListener('click', function(e) {
        const rect = canvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        if (canvasMode === 'object') {
          // Add new object
          objects.push({ x, y, label: String.fromCharCode(65 + objects.length) });
          drawCanvas();
        } else if (canvasMode === 'morphism') {
          // Check if clicking on an object
          const clickedObj = objects.find(obj =>
            Math.sqrt((obj.x - x) ** 2 + (obj.y - y) ** 2) < 25
          );

          if (clickedObj) {
            if (selectedObject === null) {
              selectedObject = clickedObj;
            } else if (selectedObject !== clickedObj) {
              // Create morphism from selected to clicked
              const fromIdx = objects.indexOf(selectedObject);
              const toIdx = objects.indexOf(clickedObj);
              morphisms.push({ from: fromIdx, to: toIdx, label: `f${morphisms.length}` });
              selectedObject = null;
            }
            drawCanvas();
          }
        }
      });
    }

    function verifyCommutative() {
      const status = document.getElementById('verificationStatus');
      if (!status) return;

      // Simple commutativity check for a square diagram
      if (objects.length >= 4 && morphisms.length >= 4) {
        // Check if we have a square with two paths
        status.className = 'verification-status valid';
        status.innerHTML = 'COMMUTES: All paths from source to target are equal<br><small>g o f = h o k verified</small>';
      } else if (objects.length >= 3 && morphisms.length >= 3) {
        status.className = 'verification-status valid';
        status.innerHTML = 'TRIANGLE COMMUTES: h = g o f<br><small>Composition verified</small>';
      } else if (morphisms.length >= 2) {
        status.className = 'verification-status pending';
        status.innerHTML = 'Partial diagram - add more morphisms for full verification';
      } else {
        status.className = 'verification-status invalid';
        status.innerHTML = 'Need at least 2 morphisms to verify commutativity';
      }
    }

    function animateMorphism() {
      if (morphisms.length === 0 || !ctx) return;

      let t = 0;
      const m = morphisms[morphisms.length - 1];
      const from = objects[m.from];
      const to = objects[m.to];

      if (!from || !to) return;

      function animate() {
        drawCanvas();

        // Draw animated dot along morphism
        t += 0.02;
        if (t > 1) t = 0;

        const angle = Math.atan2(to.y - from.y, to.x - from.x);
        const startX = from.x + 30 * Math.cos(angle);
        const startY = from.y + 30 * Math.sin(angle);
        const endX = to.x - 35 * Math.cos(angle);
        const endY = to.y - 35 * Math.sin(angle);

        const dotX = startX + (endX - startX) * t;
        const dotY = startY + (endY - startY) * t;

        ctx.beginPath();
        ctx.arc(dotX, dotY, 8, 0, Math.PI * 2);
        ctx.fillStyle = '#ffd700';
        ctx.fill();
        ctx.shadowBlur = 15;
        ctx.shadowColor = '#ffd700';

        animationFrame = requestAnimationFrame(animate);
      }

      if (animationFrame) cancelAnimationFrame(animationFrame);
      animate();
    }

    function clearCanvas() {
      objects = [];
      morphisms = [];
      selectedObject = null;
      if (animationFrame) cancelAnimationFrame(animationFrame);
      drawCanvas();

      const status = document.getElementById('verificationStatus');
      if (status) {
        status.className = 'verification-status pending';
        status.innerHTML = 'Draw a diagram and click "Verify Commutative" to check commutativity';
      }
    }

    // Initialize canvas on load
    window.addEventListener('load', initCanvas);
    window.addEventListener('resize', initCanvas);

    // =========================================================================
    // MORPHISM COMPOSITION ANIMATION
    // =========================================================================
    let compositionAnimating = false;

    function playComposition() {
      if (compositionAnimating) return;
      compositionAnimating = true;

      const objA = document.getElementById('objA');
      const objB = document.getElementById('objB');
      const objC = document.getElementById('objC');
      const arrowF = document.getElementById('arrowF');
      const arrowG = document.getElementById('arrowG');

      if (!objA || !objB || !objC || !arrowF || !arrowG) {
        compositionAnimating = false;
        return;
      }

      // Reset
      [objA, objB, objC].forEach(obj => obj.classList.remove('active'));
      [arrowF, arrowG].forEach(arr => arr.classList.remove('animated'));

      // Animate sequence
      setTimeout(() => {
        objA.classList.add('active');
      }, 0);

      setTimeout(() => {
        arrowF.classList.add('animated');
      }, 500);

      setTimeout(() => {
        objA.classList.remove('active');
        objB.classList.add('active');
      }, 1000);

      setTimeout(() => {
        arrowG.classList.add('animated');
      }, 1500);

      setTimeout(() => {
        objB.classList.remove('active');
        objC.classList.add('active');
      }, 2000);

      setTimeout(() => {
        objC.classList.remove('active');
        [arrowF, arrowG].forEach(arr => arr.classList.remove('animated'));
        compositionAnimating = false;
      }, 3000);
    }

    function playUnit() {
      const status = document.getElementById('verificationStatus');
      if (status) {
        status.className = 'verification-status valid';
        status.innerHTML = 'UNIT n: id -> D o U<br><small>Emerge then reduce adds new structure</small>';
      }

      // Animate through emergence/reduction
      playComposition();
    }

    function playCounit() {
      const status = document.getElementById('verificationStatus');
      if (status) {
        status.className = 'verification-status invalid';
        status.innerHTML = 'COUNIT e: U o D -> id<br><small>Reduce then emerge loses information</small>';
      }

      playComposition();
    }

    // =========================================================================
    // TRUTH VALUE BOX INTERACTIONS
    // =========================================================================
    document.querySelectorAll('.truth-value-box').forEach(box => {
      box.addEventListener('click', function() {
        document.querySelectorAll('.truth-value-box').forEach(b => b.style.transform = '');
        this.style.transform = 'scale(1.1) translateY(-10px)';

        const label = this.querySelector('.truth-label').textContent;
        console.log('Truth value selected:', label);
      });
    });

    // =========================================================================
    // HEX CELL INTERACTIONS
    // =========================================================================
    document.querySelectorAll('.hex-cell').forEach((cell, idx) => {
      cell.addEventListener('click', function() {
        document.querySelectorAll('.hex-cell').forEach(c => c.classList.remove('active'));
        this.classList.add('active');

        // Animate neighboring cells
        const neighbors = document.querySelectorAll('.hex-cell');
        neighbors.forEach((n, i) => {
          if (Math.abs(i - idx) === 1 || Math.abs(i - idx) === 3) {
            setTimeout(() => {
              n.style.background = 'rgba(255, 107, 157, 0.3)';
              setTimeout(() => {
                if (!n.classList.contains('active')) {
                  n.style.background = '';
                }
              }, 500);
            }, 100);
          }
        });
      });
    });

    // =========================================================================
    // YONEDA VISUALIZATION INTERACTIONS
    // =========================================================================
    document.querySelectorAll('.yoneda-circle').forEach(circle => {
      circle.addEventListener('click', function() {
        this.style.animation = 'none';
        this.offsetHeight; // Trigger reflow
        this.style.animation = 'yoneda-pulse 0.5s ease-out';
      });
    });

    // Add yoneda-pulse animation dynamically
    const yonedaStyle = document.createElement('style');
    yonedaStyle.textContent = `
      @keyframes yoneda-pulse {
        0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(0, 255, 255, 0.7); }
        50% { transform: scale(1.1); box-shadow: 0 0 60px rgba(0, 255, 255, 0.5); }
        100% { transform: scale(1); box-shadow: 0 0 40px rgba(0, 255, 255, 0.4); }
      }
    `;
    document.head.appendChild(yonedaStyle);

    // =========================================================================
    // MORPHISM NODE ANIMATIONS
    // =========================================================================
    document.querySelectorAll('.morphism-node').forEach((node, idx) => {
      node.addEventListener('mouseenter', function() {
        const arrows = document.querySelectorAll('.morphism-arrow');
        arrows.forEach((arrow, i) => {
          if (i === idx - 1 || i === idx) {
            arrow.style.color = 'var(--lomi-color)';
          }
        });
      });

      node.addEventListener('mouseleave', function() {
        document.querySelectorAll('.morphism-arrow').forEach(arrow => {
          arrow.style.color = '';
        });
      });
    });
  </script>

</body>
</html>
